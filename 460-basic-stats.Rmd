## Applying basic stats

```{r, include=FALSE}
library(tidyverse)
```

Following up on our analysis using visualizations, we will review different types of statistical tests that we can perform on data. We will again revisit the mammalian sleep dataset `msleep`.

```{r,stats1,cache=TRUE}
head(msleep)
```

------

### Describing quantitative variables

There are several ways to describe quantitative measurements. We might first look at the range of values using the `quantile` function, which returns the min, max, and median values as well as the 25th and 75th percentiles.  

```{r,stats2,cache=TRUE}
quantile(msleep$brainwt, na.rm = TRUE)
```

Note that we are using the setting `na.rm = TRUE` as an argument to these functions so that it ignores `NA` values in the data.

You can also directly isolate some of these values using the functions `min` or `max`. We might describe the center of our data, that is the mean or the median values using those respective function names. 

```{r,stats3,cache=TRUE}
median(msleep$brainwt, na.rm = TRUE)
mean(msleep$brainwt, na.rm = TRUE)
```

We might also want to describe the spread in the data, such as the standard deviation or the interquartile range. 

```{r,stats4,cache=TRUE}
sd(msleep$brainwt, na.rm = TRUE)
IQR(msleep$brainwt, na.rm = TRUE)
```

Visualizations are a great way to see this information in one picture. We have learned to create a fancier histogram, but the `hist` function always works for quick viewing.

```{r,stats5,cache=TRUE}
hist(msleep$brainwt)
```

It is clear from this image that the data is skewed towards approaching 0 with a few high outliers. 

------

### Finding differences in data

For the following statistical tests, we want to determine if measurements of a quantitative variable taken on a certain group of samples are different from similar measurements taken from a different group of samples.

To know if these differences are **statistically significant**, we need to be aware of the uncertainty in our data. Even if we have collect many observations, there is generally noisiness and error in those measurements. Thus, we have uncertainty if the mean value we calculate for a group is in fact the true mean.

We can calculate a confidence interval to describe our guess for the mean in our data. That is, we can identify the mean based on our samples, but also provide an upper or lower bound for where the mean might be.

```{r,stats6,cache=TRUE}
t.test(msleep$brainwt)
```

We use this `t.test` function because we assume that our data is normally distributed (which is not necessarily always the case) and it has a small sample size. You can see that while the mean for brain weight from this popular is 0.28, the range is fairly large (between 0.2 and 0.54) because of how big the variability is in the data.

If we want to determine if two populations have a difference in their mean values that is statistically significant, we can calculate the t-test between two sets of observations. Let's look at whether the average time spent awake by mammals who are insectivores is significantly less than those who are not.

```{r,stats7,cache=TRUE}
insectivores <- msleep %>% 
  filter(vore == "insecti") %>%
  select(awake)
head(insectivores)

other.mammals <- msleep %>% 
  filter(vore != "insecti") %>%
  select(awake)
head(other.mammals)

t.test(insectivores, other.mammals, alternative = "less")
```

These results show a p-value of 

calculate ANOVA

```{r,stats8,cache=TRUE}
anova.msleep <- aov(awake ~ vore, data = msleep)
summary(anova.msleep)
```

------

### Identifying correlations

```{r,stats9,cache=TRUE}
cor(msleep$brainwt, msleep$bodywt)
```

know how to deal with NAs

```{r,stats10,cache=TRUE}
summary(msleep$brainwt)
```

?

```{r,stats11,cache=TRUE}
msleep2 <- msleep %>% drop_na(brainwt)
dim(msleep)
dim(msleep2)
```

identify and use correlation functions
use different kinds of correlation

```{r,stats12,cache=TRUE}
cor(msleep2$brainwt, msleep2$bodywt)
```

```{r,stats13,cache=TRUE}
library(Hmisc)
rcorr(msleep2$brainwt, msleep2$bodywt, type = "pearson")
rcorr(msleep2$brainwt, msleep2$bodywt, type = "spearman")
```

------

### Producing linear models

identify and use linear regression lm() using both raw variable and formulaic interfaces

```{r,stats14,cache=TRUE}
my.mod <- lm(formula = brainwt ~ bodywt, data = msleep2)
summary(my.mod)
```

```{r,stats15,cache=TRUE}
my.mod2 <- lm(formula = sleep_total ~ bodywt + brainwt, data = msleep2)
summary(my.mod2)
```

```{r,stats16,cache=TRUE}
my.mod2 <- lm(formula = sleep_total ~ bodywt + brainwt, data = msleep2)
summary(my.mod2)
```
