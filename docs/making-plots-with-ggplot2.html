<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.4 Making plots with ggplot2 | DLL 2021, R section</title>
  <meta name="description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="3.4 Making plots with ggplot2 | DLL 2021, R section" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="github-repo" content="darachm/dll-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.4 Making plots with ggplot2 | DLL 2021, R section" />
  
  <meta name="twitter:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  

<meta name="author" content="mesako" />
<meta name="author" content="Margaret" />
<meta name="author" content="Samson" />
<meta name="author" content="Zac" />
<meta name="author" content="darachm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="using-tidyverse-1.html"/>
<link rel="next" href="making-scientific-figures.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DLL 2021 R workshops</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Workshop Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="workshop-goals.html"><a href="workshop-goals.html"><i class="fa fa-check"></i><b>1.1</b> Workshop goals</a></li>
<li class="chapter" data-level="1.2" data-path="structure-and-resources.html"><a href="structure-and-resources.html"><i class="fa fa-check"></i><b>1.2</b> Structure and resources</a><ul>
<li class="chapter" data-level="1.2.1" data-path="structure-and-resources.html"><a href="structure-and-resources.html#this-syllabus-and-videos"><i class="fa fa-check"></i><b>1.2.1</b> This syllabus and videos</a></li>
<li class="chapter" data-level="1.2.2" data-path="structure-and-resources.html"><a href="structure-and-resources.html#slack-channel"><i class="fa fa-check"></i><b>1.2.2</b> Slack channel</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="workshop-expectations.html"><a href="workshop-expectations.html"><i class="fa fa-check"></i><b>1.3</b> Workshop expectations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Day 3 - intoduction to R</a><ul>
<li class="chapter" data-level="2.1" data-path="navigating-rstudio.html"><a href="navigating-rstudio.html"><i class="fa fa-check"></i><b>2.1</b> Navigating Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="using-rmds.html"><a href="using-rmds.html"><i class="fa fa-check"></i><b>2.2</b> Using Rmds</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-r.html"><a href="getting-started-in-r.html"><i class="fa fa-check"></i><b>2.3</b> Getting started in R</a><ul>
<li class="chapter" data-level="2.3.1" data-path="getting-started-in-r.html"><a href="getting-started-in-r.html#getting-help-in-r"><i class="fa fa-check"></i><b>2.3.1</b> Getting help in R</a></li>
<li class="chapter" data-level="2.3.2" data-path="getting-started-in-r.html"><a href="getting-started-in-r.html#using-variables-and-data-types"><i class="fa fa-check"></i><b>2.3.2</b> Using variables and data types</a></li>
<li class="chapter" data-level="2.3.3" data-path="getting-started-in-r.html"><a href="getting-started-in-r.html#using-functions"><i class="fa fa-check"></i><b>2.3.3</b> Using functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="working-with-vectors.html"><a href="working-with-vectors.html"><i class="fa fa-check"></i><b>2.4</b> Working with vectors</a><ul>
<li class="chapter" data-level="2.4.1" data-path="working-with-vectors.html"><a href="working-with-vectors.html#building-vectors"><i class="fa fa-check"></i><b>2.4.1</b> Building vectors</a></li>
<li class="chapter" data-level="2.4.2" data-path="working-with-vectors.html"><a href="working-with-vectors.html#indexing-and-subsetting-vectors"><i class="fa fa-check"></i><b>2.4.2</b> Indexing and subsetting vectors</a></li>
<li class="chapter" data-level="2.4.3" data-path="working-with-vectors.html"><a href="working-with-vectors.html#using-logic-and-logicals"><i class="fa fa-check"></i><b>2.4.3</b> Using logic and logicals</a></li>
<li class="chapter" data-level="2.4.4" data-path="working-with-vectors.html"><a href="working-with-vectors.html#modifying-vectors"><i class="fa fa-check"></i><b>2.4.4</b> Modifying vectors</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html"><i class="fa fa-check"></i><b>2.5</b> Working with dataframes</a><ul>
<li class="chapter" data-level="2.5.1" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#indexing-and-subsetting-dataframes"><i class="fa fa-check"></i><b>2.5.1</b> Indexing and subsetting dataframes</a></li>
<li class="chapter" data-level="2.5.2" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#exploring-dataframes"><i class="fa fa-check"></i><b>2.5.2</b> Exploring dataframes</a></li>
<li class="chapter" data-level="2.5.3" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#building-and-modifying-dataframes"><i class="fa fa-check"></i><b>2.5.3</b> Building and modifying dataframes</a></li>
<li class="chapter" data-level="2.5.4" data-path="working-with-dataframes.html"><a href="working-with-dataframes.html#handling-datatypes-in-dataframes"><i class="fa fa-check"></i><b>2.5.4</b> Handling datatypes in dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html"><i class="fa fa-check"></i><b>3</b> Day 4 - tidyverse and visualizations</a><ul>
<li class="chapter" data-level="3.1" data-path="reading-and-processing-data.html"><a href="reading-and-processing-data.html"><i class="fa fa-check"></i><b>3.1</b> Reading and processing data</a></li>
<li class="chapter" data-level="3.2" data-path="using-tidyverse.html"><a href="using-tidyverse.html"><i class="fa fa-check"></i><b>3.2</b> Using tidyverse</a></li>
<li class="chapter" data-level="3.3" data-path="using-tidyverse-1.html"><a href="using-tidyverse-1.html"><i class="fa fa-check"></i><b>3.3</b> Using tidyverse</a></li>
<li class="chapter" data-level="3.4" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html"><i class="fa fa-check"></i><b>3.4</b> Making plots with ggplot2</a><ul>
<li class="chapter" data-level="3.4.1" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#getting-started-with-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Getting started with a ggplot</a></li>
<li class="chapter" data-level="3.4.2" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#changing-plot-aesthetics"><i class="fa fa-check"></i><b>3.4.2</b> Changing plot aesthetics</a></li>
<li class="chapter" data-level="3.4.3" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#exploring-other-plots"><i class="fa fa-check"></i><b>3.4.3</b> Exploring other plots</a></li>
<li class="chapter" data-level="3.4.4" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#using-categorical-data"><i class="fa fa-check"></i><b>3.4.4</b> Using categorical data</a></li>
<li class="chapter" data-level="3.4.5" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#visualizing-between-groups"><i class="fa fa-check"></i><b>3.4.5</b> Visualizing between groups</a></li>
<li class="chapter" data-level="3.4.6" data-path="making-plots-with-ggplot2.html"><a href="making-plots-with-ggplot2.html#generating-heatmaps"><i class="fa fa-check"></i><b>3.4.6</b> Generating heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html"><i class="fa fa-check"></i><b>3.5</b> Making scientific figures</a><ul>
<li class="chapter" data-level="3.5.1" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#plotting-error-bars"><i class="fa fa-check"></i><b>3.5.1</b> Plotting error bars</a></li>
<li class="chapter" data-level="3.5.2" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#showing-trends-in-data"><i class="fa fa-check"></i><b>3.5.2</b> Showing trends in data</a></li>
<li class="chapter" data-level="3.5.3" data-path="making-scientific-figures.html"><a href="making-scientific-figures.html#saving-figures-locally"><i class="fa fa-check"></i><b>3.5.3</b> Saving figures locally</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="applying-basic-stats.html"><a href="applying-basic-stats.html"><i class="fa fa-check"></i><b>3.6</b> Applying basic stats</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html"><i class="fa fa-check"></i><b>4</b> Day 5 - building workflows</a><ul>
<li class="chapter" data-level="4.1" data-path="using-code-many-times-loops.html"><a href="using-code-many-times-loops.html"><i class="fa fa-check"></i><b>4.1</b> Using code many times - loops</a><ul>
<li class="chapter" data-level="4.1.1" data-path="using-code-many-times-loops.html"><a href="using-code-many-times-loops.html#doing-things-multiple-times"><i class="fa fa-check"></i><b>4.1.1</b> Doing things multiple times</a></li>
<li class="chapter" data-level="4.1.2" data-path="using-code-many-times-loops.html"><a href="using-code-many-times-loops.html#loops"><i class="fa fa-check"></i><b>4.1.2</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="writing-reusable-code.html"><a href="writing-reusable-code.html"><i class="fa fa-check"></i><b>4.2</b> Writing (re)usable code</a><ul>
<li class="chapter" data-level="4.2.1" data-path="writing-reusable-code.html"><a href="writing-reusable-code.html#style-guides-can-be-inspiring"><i class="fa fa-check"></i><b>4.2.1</b> Style guides can be inspiring</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="functions-redux-why-theyre-so-great.html"><a href="functions-redux-why-theyre-so-great.html"><i class="fa fa-check"></i><b>4.3</b> Functions redux - why they’re so great</a></li>
<li class="chapter" data-level="4.4" data-path="using-functions-to-write-modular-code.html"><a href="using-functions-to-write-modular-code.html"><i class="fa fa-check"></i><b>4.4</b> Using functions to write modular code</a><ul>
<li class="chapter" data-level="4.4.1" data-path="using-functions-to-write-modular-code.html"><a href="using-functions-to-write-modular-code.html#tips-for-modular-workflows"><i class="fa fa-check"></i><b>4.4.1</b> Tips for modular workflows</a></li>
<li class="chapter" data-level="4.4.2" data-path="using-functions-to-write-modular-code.html"><a href="using-functions-to-write-modular-code.html#more-complex-workflow"><i class="fa fa-check"></i><b>4.4.2</b> More complex workflow</a></li>
<li class="chapter" data-level="4.4.3" data-path="using-functions-to-write-modular-code.html"><a href="using-functions-to-write-modular-code.html#apply-is-a-popular-tool"><i class="fa fa-check"></i><b>4.4.3</b> Apply is a popular tool</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="packages-are-chunks-of-code-and-sometimes-data.html"><a href="packages-are-chunks-of-code-and-sometimes-data.html"><i class="fa fa-check"></i><b>4.5</b> Packages are chunks of code (and sometimes data)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="packages-are-chunks-of-code-and-sometimes-data.html"><a href="packages-are-chunks-of-code-and-sometimes-data.html#cran-is-the-canonical-r-package-resource"><i class="fa fa-check"></i><b>4.5.1</b> CRAN is the canonical R package resource</a></li>
<li class="chapter" data-level="4.5.2" data-path="packages-are-chunks-of-code-and-sometimes-data.html"><a href="packages-are-chunks-of-code-and-sometimes-data.html#using-packages-without-library-ing-them"><i class="fa fa-check"></i><b>4.5.2</b> Using packages without <code>library()</code>-ing them</a></li>
<li class="chapter" data-level="4.5.3" data-path="packages-are-chunks-of-code-and-sometimes-data.html"><a href="packages-are-chunks-of-code-and-sometimes-data.html#github-is-a-common-place-for-sharing-packges-in-development"><i class="fa fa-check"></i><b>4.5.3</b> Github is a common place for sharing packges in development</a></li>
<li class="chapter" data-level="4.5.4" data-path="packages-are-chunks-of-code-and-sometimes-data.html"><a href="packages-are-chunks-of-code-and-sometimes-data.html#bioconductor-is-a-great-place-for-bio-related-packages"><i class="fa fa-check"></i><b>4.5.4</b> Bioconductor is a great place for bio-related packages 😬</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="what-packages-do-you-have-already.html"><a href="what-packages-do-you-have-already.html"><i class="fa fa-check"></i><b>4.6</b> What packages do you have already?</a></li>
<li class="chapter" data-level="4.7" data-path="finding-more-help-and-documentation.html"><a href="finding-more-help-and-documentation.html"><i class="fa fa-check"></i><b>4.7</b> Finding more help and documentation</a></li>
<li class="chapter" data-level="4.8" data-path="reproducibile-sharing-more-rmarkdown-and.html"><a href="reproducibile-sharing-more-rmarkdown-and.html"><i class="fa fa-check"></i><b>4.8</b> Reproducibile sharing - more <code>rmarkdown</code> and</a><ul>
<li class="chapter" data-level="4.8.1" data-path="reproducibile-sharing-more-rmarkdown-and.html"><a href="reproducibile-sharing-more-rmarkdown-and.html#rmarkdown-package"><i class="fa fa-check"></i><b>4.8.1</b> rmarkdown package</a></li>
<li><a href="reproducibile-sharing-more-rmarkdown-and.html#section"></a></li>
<li class="chapter" data-level="4.8.2" data-path="reproducibile-sharing-more-rmarkdown-and.html"><a href="reproducibile-sharing-more-rmarkdown-and.html#sharing-with-others"><i class="fa fa-check"></i><b>4.8.2</b> Sharing with others</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="reproducibility-and-sharing.html"><a href="reproducibility-and-sharing.html"><i class="fa fa-check"></i><b>4.9</b> Reproducibility and sharing</a></li>
<li class="chapter" data-level="4.10" data-path="troubleshooting-getting-help-dissecting-problems.html"><a href="troubleshooting-getting-help-dissecting-problems.html"><i class="fa fa-check"></i><b>4.10</b> Troubleshooting, getting help, dissecting problems</a><ul>
<li class="chapter" data-level="4.10.1" data-path="troubleshooting-getting-help-dissecting-problems.html"><a href="troubleshooting-getting-help-dissecting-problems.html#places-to-look-for-help"><i class="fa fa-check"></i><b>4.10.1</b> Places to look for help</a></li>
<li class="chapter" data-level="4.10.2" data-path="troubleshooting-getting-help-dissecting-problems.html"><a href="troubleshooting-getting-help-dissecting-problems.html#minimum-reproducible-example"><i class="fa fa-check"></i><b>4.10.2</b> Minimum reproducible example</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="conclusion-other-concepts.html"><a href="conclusion-other-concepts.html"><i class="fa fa-check"></i><b>4.11</b> Conclusion, other concepts</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>5</b> Appendix</a><ul>
<li class="chapter" data-level="5.1" data-path="additional-tutorials.html"><a href="additional-tutorials.html"><i class="fa fa-check"></i><b>5.1</b> Additional tutorials</a><ul>
<li class="chapter" data-level="5.1.1" data-path="additional-tutorials.html"><a href="additional-tutorials.html#sub-sub-section"><i class="fa fa-check"></i><b>5.1.1</b> sub sub section</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="more-challenges.html"><a href="more-challenges.html"><i class="fa fa-check"></i><b>5.2</b> More challenges</a></li>
<li class="chapter" data-level="5.3" data-path="figures-ideas.html"><a href="figures-ideas.html"><i class="fa fa-check"></i><b>5.3</b> Figures ideas</a></li>
<li class="chapter" data-level="5.4" data-path="rmd-example-of-code-chunk.html"><a href="rmd-example-of-code-chunk.html"><i class="fa fa-check"></i><b>5.4</b> Rmd example of code chunk</a></li>
<li class="chapter" data-level="5.5" data-path="more-example-rmds.html"><a href="more-example-rmds.html"><i class="fa fa-check"></i><b>5.5</b> More example Rmds</a></li>
<li class="chapter" data-level="5.6" data-path="how-to-edit-this-document.html"><a href="how-to-edit-this-document.html"><i class="fa fa-check"></i><b>5.6</b> How to edit this document</a><ul>
<li class="chapter" data-level="5.6.1" data-path="how-to-edit-this-document.html"><a href="how-to-edit-this-document.html#setup"><i class="fa fa-check"></i><b>5.6.1</b> Setup</a></li>
<li class="chapter" data-level="5.6.2" data-path="how-to-edit-this-document.html"><a href="how-to-edit-this-document.html#editwork-on-it"><i class="fa fa-check"></i><b>5.6.2</b> Edit/work on it</a></li>
<li class="chapter" data-level="5.6.3" data-path="how-to-edit-this-document.html"><a href="how-to-edit-this-document.html#publishing-onto-the-main-page-so-its-hosted-at-the-url"><i class="fa fa-check"></i><b>5.6.3</b> Publishing onto the main page, so it’s hosted at the URL</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="more-links.html"><a href="more-links.html"><i class="fa fa-check"></i><b>5.7</b> More links</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DLL 2021, R section</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="making-plots-with-ggplot2" class="section level2">
<h2><span class="header-section-number">3.4</span> Making plots with ggplot2</h2>
<p>We will primarily be working in ggplot2 as it has the greatest degree of customization for visualization and offers many additional features over the basic plotting in R.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb188-2" title="2"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div id="getting-started-with-a-ggplot" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Getting started with a ggplot</h3>
<p>Most ggplot calls to create a figure take the following form (you can read more using <code>help(ggplot)</code>):</p>
<p><code>ggplot(data = &lt;DATA&gt;, mapping = aes(&lt;MAPPINGS&gt;)) + &lt;GEOM_FUNCTION&gt;()</code></p>
<p>We will practice using our mammalian sleep dataset. You can look up more info about this dataset using the <code>help</code> function and the dataset name, <code>msleep</code>.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" title="1"><span class="kw">head</span>(msleep)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 11
##   name  genus vore  order conservation sleep_total sleep_rem sleep_cycle awake
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
## 1 Chee… Acin… carni Carn… lc                  12.1      NA        NA      11.9
## 2 Owl … Aotus omni  Prim… &lt;NA&gt;                17         1.8      NA       7  
## 3 Moun… Aplo… herbi Rode… nt                  14.4       2.4      NA       9.6
## 4 Grea… Blar… omni  Sori… lc                  14.9       2.3       0.133   9.1
## 5 Cow   Bos   herbi Arti… domesticated         4         0.7       0.667  20  
## 6 Thre… Brad… herbi Pilo… &lt;NA&gt;                14.4       2.2       0.767   9.6
## # … with 2 more variables: brainwt &lt;dbl&gt;, bodywt &lt;dbl&gt;</code></pre>
<p>You will first use the <code>ggplot()</code> function and bind the plot to a specific data frame using the data argument.</p>
<p><code>ggplot(data = msleep)</code></p>
<p>You will next need to define a mapping (using the aesthetic or <code>aes</code> function), by selecting the variables to be plotted and specifying how to present them in the graph, e.g. as x/y positions or characteristics such as size, shape, color, etc.</p>
<p><code>ggplot(data = msleep, aes(x = brainwt, y = sleep_rem))</code></p>
<p>You can then add ‘geoms’ – graphical representations of the data in the plot (points, lines, bars). ggplot2 offers many different geoms. We will use some common ones today including:</p>
<ul>
<li><code>geom_point()</code> for scatter plots, dot plots, etc.</li>
<li><code>geom_boxplot()</code> for, well, boxplots!</li>
<li><code>geom_line()</code> for trend lines, time series, etc.</li>
</ul>
<p>To add a geom to the plot use the <code>+</code> operator. Because we have two continuous variables, let’s use <code>geom_point()</code> first:</p>
<p><code>ggplot(data = msleep, aes(x = brainwt, y = sleep_rem)) + geom_point()</code></p>
<p>To save your work-in-progress, you can assign the plot to a variable.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" title="1">my_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> msleep, <span class="kw">aes</span>(<span class="dt">x =</span> brainwt, <span class="dt">y =</span> sleep_rem))</a></code></pre></div>
<p>We can now draw the plot as a scatterplot with points to represent each state.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" title="1">my_plot <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>You might notice that all of the points are squished against the y-axis since many of the mammals in this dataset have low brain weights. You can see this if you plot a very simple histogram of <code>brainwt</code> to see its distribution, or if you get summary statistics.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" title="1"><span class="kw">hist</span>(msleep<span class="op">$</span>brainwt)</a></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" title="1"><span class="kw">summary</span>(msleep<span class="op">$</span>brainwt)</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
## 0.00014 0.00290 0.01240 0.28158 0.12550 5.71200      27</code></pre>
<p>As you can see, the minimum and median values are very low, but there are a few mammals with high <code>brainwt</code> as you can see by the much larger maximum value in this vector.</p>
<p>To make more useful plots, we can transform this value using log-scaling. While we will have to note that the new values do not exactly match the real-world measurements anymore, patterns we see (i.e. something that correlates with higher brain weights) will still hold true.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1">msleep2 &lt;-<span class="st"> </span>msleep <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">brainwt_log =</span> <span class="kw">log</span>(brainwt))</a>
<a class="sourceLine" id="cb197-2" title="2"><span class="kw">ggplot</span>(msleep2, <span class="kw">aes</span>(<span class="dt">x =</span> brainwt_log, <span class="dt">y =</span> sleep_rem)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Here we use the <code>mutate</code> function to make a new variable called <code>brainwt_log</code> in our dataset (technically a new dataset copy that we have saved as <code>msleep2</code>). Plotting this variable as our x variable (i.e. independent variable), makes it easier to look for patterns.</p>
<hr />
</div>
<div id="changing-plot-aesthetics" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Changing plot aesthetics</h3>
<p>???</p>
<p>We can modify the appearance of the plot by changing aspects of the points we plot such as transparency (“alpha”) and color.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> msleep2, <span class="kw">aes</span>(<span class="dt">x =</span> brainwt_log, <span class="dt">y =</span> sleep_rem)) <span class="op">+</span></a>
<a class="sourceLine" id="cb199-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>It is also possible to scale the color of the points by some variable present in the data.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" title="1"><span class="kw">ggplot</span>(msleep2, <span class="kw">aes</span>(<span class="dt">x =</span> brainwt_log, <span class="dt">y =</span> sleep_rem, <span class="dt">color =</span> vore)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb201-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>When generating visualizations, it is important to annotate the figure with meaningful labels on the axes to make them accessible for the viewer.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1"><span class="kw">ggplot</span>(msleep2, <span class="kw">aes</span>(<span class="dt">x =</span> brainwt_log, <span class="dt">y =</span> sleep_rem, <span class="dt">color =</span> vore)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb203-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb203-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Brain Weight (log)&quot;</span>, </a>
<a class="sourceLine" id="cb203-4" title="4">       <span class="dt">y =</span> <span class="st">&quot;Duration of REM Sleep&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values (geom_point).</code></pre>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<hr />
</div>
<div id="exploring-other-plots" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Exploring other plots</h3>
<p>Let’s consider how we make other plots besides a scatterplot.</p>
<p>Scatterplots are a great way to look at two quantitative (numerical) values at the same time to observe patterns (i.e. correlations) between the variables or to identify interesting outliers.</p>
<p>However, other plots may be more useful to look at differing numbers of variables (i.e. one quantitative variable) or different types of variables (i.e. qualitative or categorical data).</p>
<p>We can create histograms in ggplot2 that are more aesthetically pleasing than the default <code>hist</code> function. This shows the distribution of one quantitative variable.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1"><span class="kw">ggplot</span>(msleep, <span class="kw">aes</span>(<span class="dt">x =</span> sleep_total)) <span class="op">+</span></a>
<a class="sourceLine" id="cb205-2" title="2"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">10</span>)</a></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" title="1"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length)) <span class="op">+</span></a>
<a class="sourceLine" id="cb206-2" title="2"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">10</span>)</a></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<hr />
</div>
<div id="using-categorical-data" class="section level3">
<h3><span class="header-section-number">3.4.4</span> Using categorical data</h3>
<p>We can look at how many individuals in the dataset fall into each category, such as feeding behavior.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> msleep, <span class="kw">aes</span>(<span class="dt">x =</span> vore)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb207-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>()</a></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>We can look at how many total sleep distribution is distributed within each category of feeding behavior using separate box plots.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> msleep, <span class="kw">aes</span>(<span class="dt">x =</span> vore, <span class="dt">y =</span> sleep_total)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb208-2" title="2"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> Sepal.Length)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb209-2" title="2"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<hr />
</div>
<div id="visualizing-between-groups" class="section level3">
<h3><span class="header-section-number">3.4.5</span> Visualizing between groups</h3>
<p>By adding a different parameter to <code>fill</code> in the <code>aes</code> we define throgh the <code>ggplot</code> function, we can separate out histograms according to different groupings such as here where we look at how total sleep distribution is distributed according to feeding behavior.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" title="1"><span class="kw">ggplot</span>(msleep, <span class="kw">aes</span>(<span class="dt">x =</span> sleep_total, <span class="dt">fill =</span> vore)) <span class="op">+</span></a>
<a class="sourceLine" id="cb210-2" title="2"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">10</span>)</a></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" title="1"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">fill =</span> Species)) <span class="op">+</span></a>
<a class="sourceLine" id="cb211-2" title="2"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">10</span>)</a></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>We can even drill down further and separate out another category, so that we can look at each feeding behavior and each conservation status (e.g. how the total sleep duration of domesticated herbivores compares to least concern carnivores).</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" title="1"><span class="kw">ggplot</span>(msleep, <span class="kw">aes</span>(<span class="dt">x =</span> vore, <span class="dt">y =</span> sleep_total, <span class="dt">color =</span> conservation)) <span class="op">+</span></a>
<a class="sourceLine" id="cb212-2" title="2"><span class="st">    </span><span class="kw">geom_boxplot</span>() </a></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<hr />
</div>
<div id="generating-heatmaps" class="section level3">
<h3><span class="header-section-number">3.4.6</span> Generating heatmaps</h3>
<p>Why no heatmaps?</p>
<p>The built-in heatmap function meets many needs while the ggplot2 equivalent (geom_tile) can be confusing. We don’t recommend ggplot2 for heatmaps.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" title="1">temp.data &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">log</span>(msleep<span class="op">$</span>brainwt), <span class="kw">log</span>(msleep<span class="op">$</span>bodywt))</a>
<a class="sourceLine" id="cb213-2" title="2"><span class="kw">head</span>(temp.data)</a></code></pre></div>
<pre><code>##            [,1]       [,2]
## [1,]         NA  3.9120230
## [2,] -4.1669153 -0.7339692
## [3,]         NA  0.3001046
## [4,] -8.1456296 -3.9633163
## [5,] -0.8603831  6.3969297
## [6,]         NA  1.3480731</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" title="1"><span class="kw">heatmap</span>(temp.data, <span class="dt">labCol =</span> <span class="kw">c</span>(<span class="st">&quot;brainwt&quot;</span>, <span class="st">&quot;bodywt&quot;</span>), <span class="dt">cexCol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" title="1"><span class="kw">heatmap</span>(temp.data, <span class="dt">scale =</span> <span class="st">&quot;col&quot;</span>, <span class="dt">labRow =</span> msleep<span class="op">$</span>name, <span class="dt">labCol =</span> <span class="kw">c</span>(<span class="st">&quot;brainwt&quot;</span>, <span class="st">&quot;bodywt&quot;</span>), <span class="dt">cexCol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" title="1">temp.data2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(temp.data, msleep<span class="op">$</span>sleep_total, msleep<span class="op">$</span>sleep_rem)</a>
<a class="sourceLine" id="cb217-2" title="2"><span class="kw">heatmap</span>(temp.data2, <span class="dt">scale =</span> <span class="st">&quot;col&quot;</span>, <span class="dt">labRow =</span> msleep<span class="op">$</span>name,</a>
<a class="sourceLine" id="cb217-3" title="3">        <span class="dt">labCol =</span> <span class="kw">c</span>(<span class="st">&quot;brainwt&quot;</span>, <span class="st">&quot;bodywt&quot;</span>, <span class="st">&quot;total_sleep&quot;</span>), <span class="dt">cexCol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="440-intro-to-ggplot2_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>

</div>
</div>
<p style="margin-top:10em;text-align:center;font-size:small;">
    <a href="https://github.com/darachm/dll-r/blob/main/LICENSE.md">
        Licensed Creative Commons Attribution-NonCommercial-ShareAlike 4.0
    </a>
</p>
<p style="text-align:center;font-size:small;">
    <a href="https://github.com/rstudio/bookdown" target="blank">
        Website typeset with bookdown
    </a>
</p>

<script> 
// This is to look through, everything that's a floating lone double dash,
// delete it. This is left over for stuff that's trying to be pauses for
// the slides
var listz = document.getElementsByTagName("p");
for (var i=0; i < listz.length; i++) { 
    if (listz[i].innerText === "–") { listz[i].innerText = "" } 
} 
</script>
            </section>

          </div>
        </div>
      </div>
<a href="using-tidyverse-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="making-scientific-figures.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/darachm/dll-r/edit/main/440-intro-to-ggplot2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DLL 2021 R syllabus site.html"],
"toc": {
"collapse": "subsection"
},
"highlight": "zenburn"
});
});
</script>

</body>

</html>
