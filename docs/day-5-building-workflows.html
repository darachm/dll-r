<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Day 5 - building workflows | DLL 2021, R section</title>
  <meta name="description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Day 5 - building workflows | DLL 2021, R section" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="github-repo" content="darachm/dll-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Day 5 - building workflows | DLL 2021, R section" />
  
  <meta name="twitter:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  

<meta name="author" content="mesako" />
<meta name="author" content="Margaret" />
<meta name="author" content="Samson" />
<meta name="author" content="Zac" />
<meta name="author" content="darachm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="day-4-tidyverse-and-visualizations.html"/>
<link rel="next" href="appendix.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DLL 2021 R workshops</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Workshop introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#workshop-goals"><i class="fa fa-check"></i><b>1.1</b> Workshop goals</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#structure-and-resources"><i class="fa fa-check"></i><b>1.2</b> Structure and resources</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#this-syllabus-and-videos"><i class="fa fa-check"></i><b>1.2.1</b> This syllabus and videos</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#slack-channel"><i class="fa fa-check"></i><b>1.2.2</b> Slack channel</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#workshop-expectations"><i class="fa fa-check"></i><b>1.3</b> Workshop expectations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Day 3 - intoduction to R</a><ul>
<li class="chapter" data-level="2.1" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#navigating-rstudio"><i class="fa fa-check"></i><b>2.1</b> Navigating Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#using-rmds"><i class="fa fa-check"></i><b>2.2</b> Using Rmds</a></li>
<li class="chapter" data-level="2.3" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#getting-started-in-r"><i class="fa fa-check"></i><b>2.3</b> Getting started in R</a><ul>
<li class="chapter" data-level="2.3.1" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#getting-help-in-r"><i class="fa fa-check"></i><b>2.3.1</b> Getting help in R</a></li>
<li class="chapter" data-level="2.3.2" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#using-variables-and-data-types"><i class="fa fa-check"></i><b>2.3.2</b> Using variables and data types</a></li>
<li class="chapter" data-level="2.3.3" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#using-functions"><i class="fa fa-check"></i><b>2.3.3</b> Using functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#working-with-vectors"><i class="fa fa-check"></i><b>2.4</b> Working with vectors</a><ul>
<li class="chapter" data-level="2.4.1" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#building-vectors"><i class="fa fa-check"></i><b>2.4.1</b> Building vectors</a></li>
<li class="chapter" data-level="2.4.2" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#indexing-and-subsetting-vectors"><i class="fa fa-check"></i><b>2.4.2</b> Indexing and subsetting vectors</a></li>
<li class="chapter" data-level="2.4.3" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#using-logic-and-logicals"><i class="fa fa-check"></i><b>2.4.3</b> Using logic and logicals</a></li>
<li class="chapter" data-level="2.4.4" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#modifying-vectors"><i class="fa fa-check"></i><b>2.4.4</b> Modifying vectors</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#working-with-dataframes"><i class="fa fa-check"></i><b>2.5</b> Working with dataframes</a><ul>
<li class="chapter" data-level="2.5.1" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#indexing-and-subsetting-dataframes"><i class="fa fa-check"></i><b>2.5.1</b> Indexing and subsetting dataframes</a></li>
<li class="chapter" data-level="2.5.2" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#exploring-dataframes"><i class="fa fa-check"></i><b>2.5.2</b> Exploring dataframes</a></li>
<li class="chapter" data-level="2.5.3" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#building-and-modifying-dataframes"><i class="fa fa-check"></i><b>2.5.3</b> Building and modifying dataframes</a></li>
<li class="chapter" data-level="2.5.4" data-path="day-3-intoduction-to-r.html"><a href="day-3-intoduction-to-r.html#handling-datatypes-in-dataframes"><i class="fa fa-check"></i><b>2.5.4</b> Handling datatypes in dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html"><i class="fa fa-check"></i><b>3</b> Day 4 - tidyverse and visualizations</a><ul>
<li class="chapter" data-level="3.1" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#reading-and-processing-data"><i class="fa fa-check"></i><b>3.1</b> Reading and processing data</a></li>
<li class="chapter" data-level="3.2" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#using-tidyverse"><i class="fa fa-check"></i><b>3.2</b> Using tidyverse</a></li>
<li class="chapter" data-level="3.3" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#using-tidyverse-1"><i class="fa fa-check"></i><b>3.3</b> Using tidyverse</a></li>
<li class="chapter" data-level="3.4" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#making-plots-with-ggplot2"><i class="fa fa-check"></i><b>3.4</b> Making plots with ggplot2</a><ul>
<li class="chapter" data-level="3.4.1" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#getting-started-with-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Getting started with a ggplot</a></li>
<li class="chapter" data-level="3.4.2" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#changing-plot-aesthetics"><i class="fa fa-check"></i><b>3.4.2</b> Changing plot aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#exploring-other-plots"><i class="fa fa-check"></i><b>3.5</b> Exploring other plots</a><ul>
<li class="chapter" data-level="3.5.1" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#using-categorical-data"><i class="fa fa-check"></i><b>3.5.1</b> Using categorical data</a></li>
<li class="chapter" data-level="3.5.2" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#visualizing-between-groups"><i class="fa fa-check"></i><b>3.5.2</b> Visualizing between groups</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#making-scientific-figures"><i class="fa fa-check"></i><b>3.6</b> Making scientific figures</a><ul>
<li class="chapter" data-level="3.6.1" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#plotting-error-bars"><i class="fa fa-check"></i><b>3.6.1</b> Plotting error bars</a></li>
<li class="chapter" data-level="3.6.2" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#showing-trends-in-data"><i class="fa fa-check"></i><b>3.6.2</b> Showing trends in data</a></li>
<li class="chapter" data-level="3.6.3" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#saving-figures-locally"><i class="fa fa-check"></i><b>3.6.3</b> Saving figures locally</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="day-4-tidyverse-and-visualizations.html"><a href="day-4-tidyverse-and-visualizations.html#applying-basic-stats"><i class="fa fa-check"></i><b>3.7</b> Applying basic stats</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html"><i class="fa fa-check"></i><b>4</b> Day 5 - building workflows</a><ul>
<li class="chapter" data-level="4.1" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#using-code-many-times---loops"><i class="fa fa-check"></i><b>4.1</b> Using code many times - loops</a><ul>
<li class="chapter" data-level="4.1.1" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#doing-things-multiple-times"><i class="fa fa-check"></i><b>4.1.1</b> Doing things multiple times</a></li>
<li class="chapter" data-level="4.1.2" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#loops"><i class="fa fa-check"></i><b>4.1.2</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#writing-reusable-code"><i class="fa fa-check"></i><b>4.2</b> Writing (re)usable code</a><ul>
<li class="chapter" data-level="4.2.1" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#style-guides-can-be-inspiring"><i class="fa fa-check"></i><b>4.2.1</b> Style guides can be inspiring</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#functions-redux---why-theyre-so-great"><i class="fa fa-check"></i><b>4.3</b> Functions redux - why they’re so great</a></li>
<li class="chapter" data-level="4.4" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#using-functions-to-write-modular-code"><i class="fa fa-check"></i><b>4.4</b> Using functions to write modular code</a><ul>
<li class="chapter" data-level="4.4.1" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#tips-for-modular-workflows"><i class="fa fa-check"></i><b>4.4.1</b> Tips for modular workflows</a></li>
<li class="chapter" data-level="4.4.2" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#more-complex-workflow"><i class="fa fa-check"></i><b>4.4.2</b> More complex workflow</a></li>
<li class="chapter" data-level="4.4.3" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#apply-is-a-popular-tool"><i class="fa fa-check"></i><b>4.4.3</b> Apply is a popular tool</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#packages-are-chunks-of-code-and-sometimes-data"><i class="fa fa-check"></i><b>4.5</b> Packages are chunks of code (and sometimes data)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#cran-is-the-canonical-r-package-resource"><i class="fa fa-check"></i><b>4.5.1</b> CRAN is the canonical R package resource</a></li>
<li class="chapter" data-level="4.5.2" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#github-is-a-common-place-for-sharing-code-in-development"><i class="fa fa-check"></i><b>4.5.2</b> github is a common place for sharing code in development</a></li>
<li class="chapter" data-level="4.5.3" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#bioconductor-is-a-great-place-for-bio-related-packages"><i class="fa fa-check"></i><b>4.5.3</b> Bioconductor is a great place for bio-related packages 😬</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#finding-more-help-and-documentation"><i class="fa fa-check"></i><b>4.6</b> Finding more help and documentation</a></li>
<li class="chapter" data-level="4.7" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#reproducibile-sharing---more-rmarkdown-and"><i class="fa fa-check"></i><b>4.7</b> Reproducibile sharing - more <code>rmarkdown</code> and</a><ul>
<li class="chapter" data-level="4.7.1" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#rmarkdown-package"><i class="fa fa-check"></i><b>4.7.1</b> rmarkdown package</a></li>
<li><a href="day-5-building-workflows.html#section"></a></li>
<li class="chapter" data-level="4.7.2" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#sharing-with-others"><i class="fa fa-check"></i><b>4.7.2</b> Sharing with others</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#reproducibility-and-sharing"><i class="fa fa-check"></i><b>4.8</b> Reproducibility and sharing</a></li>
<li class="chapter" data-level="4.9" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#troubleshooting-getting-help-dissecting-problems"><i class="fa fa-check"></i><b>4.9</b> Troubleshooting, getting help, dissecting problems</a><ul>
<li class="chapter" data-level="4.9.1" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#places-to-look-for-help"><i class="fa fa-check"></i><b>4.9.1</b> Places to look for help</a></li>
<li class="chapter" data-level="4.9.2" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#minimum-reproducible-example"><i class="fa fa-check"></i><b>4.9.2</b> Minimum reproducible example</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="day-5-building-workflows.html"><a href="day-5-building-workflows.html#conclusion-other-concepts"><i class="fa fa-check"></i><b>4.10</b> Conclusion, other concepts</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>5</b> Appendix</a><ul>
<li class="chapter" data-level="5.1" data-path="appendix.html"><a href="appendix.html#additional-tutorials"><i class="fa fa-check"></i><b>5.1</b> Additional tutorials</a><ul>
<li class="chapter" data-level="5.1.1" data-path="appendix.html"><a href="appendix.html#sub-sub-section"><i class="fa fa-check"></i><b>5.1.1</b> sub sub section</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="appendix.html"><a href="appendix.html#more-challenges"><i class="fa fa-check"></i><b>5.2</b> More challenges</a></li>
<li class="chapter" data-level="5.3" data-path="appendix.html"><a href="appendix.html#figures-ideas"><i class="fa fa-check"></i><b>5.3</b> Figures ideas</a></li>
<li class="chapter" data-level="5.4" data-path="appendix.html"><a href="appendix.html#rmd-example-of-code-chunk"><i class="fa fa-check"></i><b>5.4</b> Rmd example of code chunk</a></li>
<li class="chapter" data-level="5.5" data-path="appendix.html"><a href="appendix.html#more-example-rmds"><i class="fa fa-check"></i><b>5.5</b> More example Rmds</a></li>
<li class="chapter" data-level="5.6" data-path="appendix.html"><a href="appendix.html#how-to-edit-this-document"><i class="fa fa-check"></i><b>5.6</b> How to edit this document</a><ul>
<li class="chapter" data-level="5.6.1" data-path="appendix.html"><a href="appendix.html#setup"><i class="fa fa-check"></i><b>5.6.1</b> Setup</a></li>
<li class="chapter" data-level="5.6.2" data-path="appendix.html"><a href="appendix.html#editwork-on-it"><i class="fa fa-check"></i><b>5.6.2</b> Edit/work on it</a></li>
<li class="chapter" data-level="5.6.3" data-path="appendix.html"><a href="appendix.html#publishing-onto-the-main-page-so-its-hosted-at-the-url"><i class="fa fa-check"></i><b>5.6.3</b> Publishing onto the main page, so it’s hosted at the URL</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="appendix.html"><a href="appendix.html#more-links"><i class="fa fa-check"></i><b>5.7</b> More links</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DLL 2021, R section</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="day-5---building-workflows" class="section level1">
<h1><span class="header-section-number">4</span> Day 5 - building workflows</h1>
<p>Today we’re going to learn about applying these R
skills to
repeat, reproduce, extend, and share your analyses.</p>
<p>First, let’s review the last two days.</p>
<!-- exercise -->
<ul>
<li>What have we done?</li>
<li>How do we do it many times?</li>
<li>Crack open your code - can you use it again?</li>
<li>Can you adapt it to modify your question,
feed in new data, and modify the
scientifically-important bits easily?</li>
<li>Can you share it with someone and they follow
along?</li>
</ul>

<div id="using-code-many-times---loops" class="section level2">
<h2><span class="header-section-number">4.1</span> Using code many times - loops</h2>
<p>You will want to do the same thing multiple
times - automation is great. Let’s code up a
simple little analysis - we’ll calculate the
length (number of amino acids) in a viral
structural protein sequence.</p>
<p>These files are in the <code>data/viral_structural_proteins</code> folder,
are tab-delimited three fields, and look like this:</p>
<pre><code>Q8V433.1 Membrane protein       Bovine respiratory coronavirus (strain 98TXSF-110-LUN)  MSSVTTPAPVYTWTA...</code></pre>
<hr />
<p>Let’s read one in.
We’ll need to use <code>read.delim</code>, specify a tab separator, and ignore the lack
of a header.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb284-1" data-line-number="1">viral_protein_data &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;data/viral_structural_proteins/viral_proteins_100.tsv&quot;</span>,</a>
<a class="sourceLine" id="cb284-2" data-line-number="2">    <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,<span class="dt">header=</span>F)</a>
<a class="sourceLine" id="cb284-3" data-line-number="3">viral_protein_data</a></code></pre></div>
<pre><code>##                           V1
## 1 Q8V433.1 Membrane protein 
##                                                       V2
## 1 Bovine respiratory coronavirus (strain 98TXSF-110-LUN)
##                                                                                                                                                                                                                                       V3
## 1 MSSVTTPAPVYTWTADEAIKFLKEWNFSLGIILLFITVILQFGYTSRSMFVYVIKMIILWLMWPLTIILTIFNCVYALNNVYLGFSIVFTIVAIIMWIVYFVNSIRLFIRTGSWWSFNPETNNLMCIDMKGRMYVRPIIEDYHTLTVTIIRGHLYMQGIKLGTGYSLSDLPAYVTVAKVSHLLTYKRGFLDKIGDTSGFAVYVKSKVGNYRLPSTQKGSGLDTALLRNNI</code></pre>
<ul>
<li>How do we find the column names?</li>
<li>What are two ways to access the protein sequence?</li>
<li>How do we calculate the number of characters in this sequence?</li>
</ul>
<!-- ??"number of characters" -->
<p>Code it up!</p>
<hr />
<div id="doing-things-multiple-times" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Doing things multiple times</h3>
<p>Let’s do this for all the proteins.
The simplest way of doing this is to copy and
paste it.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" data-line-number="1">viral_protein_data &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;data/viral_structural_proteins/viral_proteins_002.tsv&quot;</span>,</a>
<a class="sourceLine" id="cb286-2" data-line-number="2">      <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,<span class="dt">header=</span>F, <span class="dt">as.is=</span>T)</a>
<a class="sourceLine" id="cb286-3" data-line-number="3"><span class="kw">nchar</span>(viral_protein_data<span class="op">$</span>V3[[<span class="dv">1</span>]])</a></code></pre></div>
<pre><code>## [1] 177</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" data-line-number="1">viral_protein_data &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;data/viral_structural_proteins/viral_proteins_003.tsv&quot;</span>,</a>
<a class="sourceLine" id="cb288-2" data-line-number="2">      <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,<span class="dt">header=</span>F, <span class="dt">as.is=</span>T)</a>
<a class="sourceLine" id="cb288-3" data-line-number="3"><span class="kw">nchar</span>(viral_protein_data[<span class="dv">1</span>,<span class="st">&quot;V3&quot;</span>])</a></code></pre></div>
<pre><code>## [1] 137</code></pre>
<p>Go ahead and do this for all 242 proteins</p>
<hr />
<p>… just kidding.</p>
<p>Try this to, well, list files:</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb290-1" data-line-number="1"><span class="kw">list.files</span>(<span class="dt">path=</span><span class="st">&quot;data/viral_structural_proteins&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a></code></pre></div>
<pre><code>## [1] &quot;viral_proteins_000.tsv&quot; &quot;viral_proteins_001.tsv&quot; &quot;viral_proteins_002.tsv&quot;
## [4] &quot;viral_proteins_003.tsv&quot; &quot;viral_proteins_004.tsv&quot;</code></pre>
<p>Note that I put a <code>[1:5]</code> to limit it to the first 5.
You could also use <code>head()</code>. It’s a good idea to work
with a small subset of files while you are iterating
through development, then scale it up to the entirety.</p>
<p>Now how do you calculate the number of characters for each protein?</p>
<p>How do we do this for every file listed … ?</p>
<hr />
</div>
<div id="loops" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Loops</h3>
<!-- video -->
<p>Loops are for running a “code block” as many times
as the “condition” determines.</p>
<ul>
<li><p>A “code block” is either one line of code, or multiple
lines of code surrounded by curly brackets - {}</p>
<pre><code>  {
      code &lt;- &quot;in a block&quot; 
      with &lt;- &quot;multiple lines&quot; 
  }</code></pre></li>
<li><p>A “condition” is an expression of code that
can either evaluate to either <code>TRUE</code> or <code>FALSE</code>, or
set a variable for each time running the code block.</p></li>
</ul>
<p>The most common form of this is a <code>for</code> loop.
Other “control statements” or “flow control statements” are
<code>while</code>, <code>repeat</code>, and <code>if</code>.</p>
<p>Let’s look up what they do, with “?<code>for</code>”
Note the back ticks! These are a trick in R to make anything
be interpreted as literally what you type, and not
any special characters. Like “?<code>+</code>”, or “?<code>?</code>”</p>
<hr />
<p>Here’s an example loop:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" data-line-number="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb293-2" data-line-number="2">  <span class="kw">print</span>(i)</a>
<a class="sourceLine" id="cb293-3" data-line-number="3">}</a></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3
## [1] 4</code></pre>
<p>The pieces:</p>
<ul>
<li><p><code>(i in 1:4)</code> is what is being looped over - <code>1:4</code> is a vector of
1 through 4 that is created, and it is put one at a time into <code>i</code>
(a new variable). You need the parentheses.</p></li>
<li><p><code>{</code> and <code>}</code> denote the opening and closing brackets, specify the
“code block” that is run each time.</p></li>
<li><p>inside this “code block” is <code>print(i)</code> - it prints the variable <code>i</code>,
which is set to a value of 1, 2, 3, or 4 for each loop</p></li>
</ul>
<hr />
<p>How do we loop through and print each file name?</p>
<p>What are the (1) code block and (2) loop condition ?</p>
<div class="incremental">
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" data-line-number="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">list.files</span>(<span class="dt">path=</span><span class="st">&quot;data/viral_structural_proteins&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] ) {</a>
<a class="sourceLine" id="cb295-2" data-line-number="2">  <span class="kw">print</span>(i)</a>
<a class="sourceLine" id="cb295-3" data-line-number="3">}</a></code></pre></div>
<pre><code>## [1] &quot;viral_proteins_000.tsv&quot;
## [1] &quot;viral_proteins_001.tsv&quot;
## [1] &quot;viral_proteins_002.tsv&quot;
## [1] &quot;viral_proteins_003.tsv&quot;
## [1] &quot;viral_proteins_004.tsv&quot;</code></pre>
<p>How do we modify this to calculate the protein length?</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" data-line-number="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">list.files</span>(<span class="dt">path=</span><span class="st">&quot;data/viral_structural_proteins&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] ) {</a>
<a class="sourceLine" id="cb297-2" data-line-number="2">  <span class="kw">print</span>(i)</a>
<a class="sourceLine" id="cb297-3" data-line-number="3">  <span class="kw">print</span>(<span class="kw">nchar</span>(<span class="kw">read.delim</span>(i)<span class="op">$</span>V3[[<span class="dv">1</span>]]))</a>
<a class="sourceLine" id="cb297-4" data-line-number="4">}</a></code></pre></div>
<pre><code>## [1] &quot;viral_proteins_000.tsv&quot;</code></pre>
<pre><code>## Warning in file(file, &quot;rt&quot;): cannot open file &#39;viral_proteins_000.tsv&#39;: No such
## file or directory</code></pre>
<pre><code>## Error in file(file, &quot;rt&quot;): cannot open the connection</code></pre>
</div>
<hr />
<p>Debugging…</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" data-line-number="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">list.files</span>(<span class="dt">path=</span><span class="st">&quot;data/viral_structural_proteins&quot;</span>,</a>
<a class="sourceLine" id="cb301-2" data-line-number="2">                     <span class="dt">full.names=</span>T)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] ) {</a>
<a class="sourceLine" id="cb301-3" data-line-number="3">  <span class="kw">print</span>(<span class="kw">nchar</span>(<span class="kw">read.delim</span>(i,<span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,<span class="dt">header=</span>F,<span class="dt">as.is=</span>T)<span class="op">$</span>V3[[<span class="dv">1</span>]]))</a>
<a class="sourceLine" id="cb301-4" data-line-number="4">}</a></code></pre></div>
<pre><code>## [1] 1248
## [1] 1254
## [1] 177
## [1] 137
## [1] 117</code></pre>
<hr />
<div id="storing-values-from-a-loop" class="section level4">
<h4><span class="header-section-number">4.1.2.1</span> Storing values from a loop</h4>
<p>How do we store this value?</p>
<p>In other languages, “append”. But R is not built that way. It’ll work,
but it’s very inefficient. The “R-way” to store values from a loop
is to define a vector of the right length,
then put each element in it.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" data-line-number="1"><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>,<span class="dv">10</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" data-line-number="1"><span class="kw">vector</span>(<span class="dt">mode=</span><span class="st">&quot;numeric&quot;</span>,<span class="dt">length=</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] 0 0 0 0 0</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb307-1" data-line-number="1"><span class="kw">vector</span>(<span class="st">&quot;logical&quot;</span>,<span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] FALSE FALSE</code></pre>
<hr />
<p>Okay, but how do we access each position to save the value?
We need to turn out list of files into indicies.
We’ll save it first so we can count how many there are.</p>
<p><code>seq_along</code> is handy function, otherwise use something like
<code>seq(1,length(x))</code>.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" data-line-number="1">first_five &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path=</span><span class="st">&quot;data/viral_structural_proteins&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb309-2" data-line-number="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(first_five) ) {</a>
<a class="sourceLine" id="cb309-3" data-line-number="3">  <span class="kw">print</span>(first_five[i])</a>
<a class="sourceLine" id="cb309-4" data-line-number="4">}</a></code></pre></div>
<pre><code>## [1] &quot;viral_proteins_000.tsv&quot;
## [1] &quot;viral_proteins_001.tsv&quot;
## [1] &quot;viral_proteins_002.tsv&quot;
## [1] &quot;viral_proteins_003.tsv&quot;
## [1] &quot;viral_proteins_004.tsv&quot;</code></pre>
<hr />
<p>Putting these together, we can save a vector of file names:</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" data-line-number="1">first_five &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path=</span><span class="st">&quot;data/viral_structural_proteins&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb311-2" data-line-number="2">filenamez &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>,<span class="kw">length</span>(first_five))</a>
<a class="sourceLine" id="cb311-3" data-line-number="3"></a>
<a class="sourceLine" id="cb311-4" data-line-number="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(first_five) ) {</a>
<a class="sourceLine" id="cb311-5" data-line-number="5">  filenamez[i] &lt;-<span class="st"> </span>first_five[i]</a>
<a class="sourceLine" id="cb311-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb311-7" data-line-number="7"></a>
<a class="sourceLine" id="cb311-8" data-line-number="8">filenamez</a></code></pre></div>
<pre><code>## [1] &quot;viral_proteins_000.tsv&quot; &quot;viral_proteins_001.tsv&quot; &quot;viral_proteins_002.tsv&quot;
## [4] &quot;viral_proteins_003.tsv&quot; &quot;viral_proteins_004.tsv&quot;</code></pre>
<hr />
<p>And finally calculate the length of each protein:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" data-line-number="1">first_five &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path=</span><span class="st">&quot;data/viral_structural_proteins&quot;</span>,</a>
<a class="sourceLine" id="cb313-2" data-line-number="2">                         <span class="dt">full.names=</span>T, <span class="dt">pattern=</span><span class="st">&quot;.*tsv&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb313-3" data-line-number="3">lengthz &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>,<span class="kw">length</span>(first_five))</a>
<a class="sourceLine" id="cb313-4" data-line-number="4"></a>
<a class="sourceLine" id="cb313-5" data-line-number="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(first_five) ) {</a>
<a class="sourceLine" id="cb313-6" data-line-number="6">  lengthz[i] &lt;-<span class="st"> </span><span class="kw">nchar</span>( <span class="kw">read.delim</span>(first_five[i],</a>
<a class="sourceLine" id="cb313-7" data-line-number="7">      <span class="dt">header=</span>F,<span class="dt">as.is=</span>T,<span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)<span class="op">$</span>V3[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb313-8" data-line-number="8">    )</a>
<a class="sourceLine" id="cb313-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb313-10" data-line-number="10"></a>
<a class="sourceLine" id="cb313-11" data-line-number="11">lengthz</a></code></pre></div>
<pre><code>## [1] &quot;1248&quot; &quot;1254&quot; &quot;177&quot;  &quot;137&quot;  &quot;117&quot;</code></pre>
<hr />
<p>Now we can take off the <code>[1:5]</code> limiter, and do the whole set:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb315-1" data-line-number="1">first_five &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path=</span><span class="st">&quot;data/viral_structural_proteins&quot;</span>,</a>
<a class="sourceLine" id="cb315-2" data-line-number="2">                         <span class="dt">full.names=</span>T, <span class="dt">pattern=</span><span class="st">&quot;.*tsv&quot;</span>)</a>
<a class="sourceLine" id="cb315-3" data-line-number="3">lengthz &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>,<span class="kw">length</span>(first_five))</a>
<a class="sourceLine" id="cb315-4" data-line-number="4"></a>
<a class="sourceLine" id="cb315-5" data-line-number="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(first_five) ) {</a>
<a class="sourceLine" id="cb315-6" data-line-number="6">  lengthz[i] &lt;-<span class="st"> </span><span class="kw">nchar</span>( <span class="kw">read.delim</span>(first_five[i],</a>
<a class="sourceLine" id="cb315-7" data-line-number="7">      <span class="dt">header=</span>F,<span class="dt">as.is=</span>T,<span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)<span class="op">$</span>V3[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb315-8" data-line-number="8">    )</a>
<a class="sourceLine" id="cb315-9" data-line-number="9">}</a></code></pre></div>
<hr />
<p>How do we go about visualizing/analyzing this?</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" data-line-number="1"><span class="kw">hist</span>(lengthz)</a></code></pre></div>
<pre><code>## Error in hist.default(lengthz): &#39;x&#39; must be numeric</code></pre>
<p>er what…?</p>
<p>Numeric….</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" data-line-number="1">first_five &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path=</span><span class="st">&quot;data/viral_structural_proteins&quot;</span>,</a>
<a class="sourceLine" id="cb318-2" data-line-number="2">                         <span class="dt">full.names=</span>T, <span class="dt">pattern=</span><span class="st">&quot;.*tsv&quot;</span>)</a>
<a class="sourceLine" id="cb318-3" data-line-number="3">lengthz &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;numeric&quot;</span>,<span class="kw">length</span>(first_five))</a>
<a class="sourceLine" id="cb318-4" data-line-number="4"></a>
<a class="sourceLine" id="cb318-5" data-line-number="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(first_five) ) {</a>
<a class="sourceLine" id="cb318-6" data-line-number="6">  lengthz[i] &lt;-<span class="st"> </span><span class="kw">nchar</span>( <span class="kw">read.delim</span>(first_five[i],</a>
<a class="sourceLine" id="cb318-7" data-line-number="7">      <span class="dt">header=</span>F,<span class="dt">as.is=</span>T,<span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)<span class="op">$</span>V3[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb318-8" data-line-number="8">    )</a>
<a class="sourceLine" id="cb318-9" data-line-number="9">}</a></code></pre></div>
<hr />
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb319-1" data-line-number="1"><span class="kw">hist</span>(lengthz,<span class="dt">breaks=</span><span class="dv">50</span>)</a></code></pre></div>
<p><img src="510-loops_files/figure-html/base_viz_protein_lengths_fix-1.png" width="672" /></p>
<hr />
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb320-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb320-2" data-line-number="2"><span class="kw">ggplot</span>( <span class="kw">data.frame</span>(<span class="dt">length=</span>lengthz) )<span class="op">+</span><span class="kw">theme_classic</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb320-3" data-line-number="3"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x=</span>length)<span class="op">+</span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">50</span>)</a></code></pre></div>
<p><img src="510-loops_files/figure-html/ggplot_viz_protein_lengths-1.png" width="672" /></p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb321-1" data-line-number="1"><span class="kw">summary</span>(lengthz)</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##     1.0   231.5   646.0   729.2  1089.0  3390.0</code></pre>
<hr />

</div>
</div>
</div>
<div id="writing-reusable-code" class="section level2">
<h2><span class="header-section-number">4.2</span> Writing (re)usable code</h2>
<ul>
<li><p>Crack open your code - can you use it again?</p></li>
<li><p>Can you adapt it to modify your question, feed in new data,
and modify the scientifically-important bits easily?</p></li>
</ul>
<hr />
<div id="examples" class="section level4">
<h4><span class="header-section-number">4.2.0.1</span> Examples</h4>
<p>Let’s look at two chunks of code from
<a href="https://github.com/sashaflevy/PPiSeq">a paper</a> (lightly edited).
The experiment is counting barcoded lineages of yeast cells to estimate
“PPIs” (protein-protein interactions)
<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>Here’s an example of one style of writing R script:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" data-line-number="1"><span class="co"># filter out bad barcode lineages ( &lt;= 2 time points counts &gt; 0, or maximum of each time point &lt;= 5 or total counts of a lineage &lt; 10)</span></a>
<a class="sourceLine" id="cb323-2" data-line-number="2">bad_index =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(DBC_known_counts))</a>
<a class="sourceLine" id="cb323-3" data-line-number="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(bad_index)){</a>
<a class="sourceLine" id="cb323-4" data-line-number="4">        counts =<span class="st"> </span><span class="kw">as.numeric</span>(DBC_known_counts[i, <span class="dv">4</span><span class="op">:</span><span class="dv">8</span>])</a>
<a class="sourceLine" id="cb323-5" data-line-number="5">        <span class="cf">if</span> (<span class="kw">length</span>(<span class="kw">which</span>(counts <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)) <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span> <span class="op">|</span><span class="st"> </span><span class="kw">max</span>(counts) <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span><span class="kw">sum</span>(counts) <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb323-6" data-line-number="6">                bad_index[i] =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb323-7" data-line-number="7">        }</a>
<a class="sourceLine" id="cb323-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb323-9" data-line-number="9"><span class="kw">length</span>(<span class="kw">which</span>(bad_index <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)) <span class="co"># 1447775</span></a></code></pre></div>
<!-- exercise -->
<ul>
<li>What is going on here?</li>
<li>How do you feed in new data?</li>
<li>How do you run this multiple times?</li>
<li>How do you change the logic?</li>
</ul>
<hr />
<p>Here’s another example from the same author:</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" data-line-number="1">H202_Output &lt;-<span class="st"> </span><span class="kw">PPI_calling_sigmoid</span>(</a>
<a class="sourceLine" id="cb324-2" data-line-number="2">    <span class="dt">PPI_multiple=</span><span class="kw">dataFrameReader_T</span>(<span class="st">&quot;/Volumes/zmliu_02/PPiseq_03/H2O2/counts/PPI_multiple_p.values.csv&quot;</span>),</a>
<a class="sourceLine" id="cb324-3" data-line-number="3">    <span class="dt">specific_PPV=</span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="fl">0.5</span>,<span class="fl">0.58</span>,<span class="dt">by=</span><span class="fl">0.02</span>),<span class="kw">seq</span>(<span class="fl">0.6</span>,<span class="fl">0.8</span>,<span class="dt">by=</span><span class="fl">0.01</span>),<span class="kw">seq</span>(<span class="fl">0.82</span>,<span class="fl">0.9</span>,<span class="dt">by=</span><span class="fl">0.02</span>)),</a>
<a class="sourceLine" id="cb324-4" data-line-number="4">    <span class="dt">Fitness=</span><span class="kw">fitness</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>),</a>
<a class="sourceLine" id="cb324-5" data-line-number="5">    <span class="dt">p_value=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb324-6" data-line-number="6">    <span class="dt">Neg_number_PPI=</span><span class="fl">6e4</span>,</a>
<a class="sourceLine" id="cb324-7" data-line-number="7">    <span class="dt">Neg_ref_number=</span><span class="dv">50</span>, </a>
<a class="sourceLine" id="cb324-8" data-line-number="8">    <span class="dt">p_threshold=</span><span class="op">-</span><span class="dv">4</span></a>
<a class="sourceLine" id="cb324-9" data-line-number="9">    <span class="dt">p_loc=</span><span class="dv">6</span>, </a>
<a class="sourceLine" id="cb324-10" data-line-number="10">)</a></code></pre></div>
<!-- exercise -->
<p>Same questions.</p>
<hr />
<p>What are some differences?</p>
<p>What’s useful for you?</p>
<p>What’s a lot of effort to do?</p>
<hr />
</div>
<div id="style-guides-can-be-inspiring" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Style guides can be inspiring</h3>
<ul>
<li><a href="https://style.tidyverse.org/">tidyverse style guide</a></li>
<li><a href="https://google.github.io/styleguide/Rguide.html">google-specific changes</a></li>
<li><a href="https://jef.works/R-style-guide/">Jean Fan’s</a></li>
<li>search for “R style guide”</li>
</ul>
<p>What style should you use?</p>
<p>Be inconsistently consistent!
Balance for yourself:</p>
<ul>
<li>How easy is it to write?</li>
<li>How easy is it for you to read?</li>
<li>How easy is it for others to read?</li>
<li>How similar is it to what everyone else is doing (a very good thing)?</li>
</ul>
<p>But most importantly, use what folks around you are using.
Be lazy, imitate others!</p>
<hr />
<!-- exercise -->
<ul>
<li>How would you describe your code writing style?</li>
<li>How do you name things?</li>
<li>How good are your comments?</li>
<li>What ideas would you like to incorporate?</li>
</ul>
<hr />

<!--

```{=html}
<div class="incremental">
```
```{=html}
</div>
```

-->
</div>
</div>
<div id="functions-redux---why-theyre-so-great" class="section level2">
<h2><span class="header-section-number">4.3</span> Functions redux - why they’re so great</h2>
<p>Functions are handy.
For example, let’s calculate the standard error of a sample of values:</p>
<div class="incremental">
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" data-line-number="1">values &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb325-2" data-line-number="2"><span class="kw">stderr</span>(values)</a></code></pre></div>
<pre><code>## Error in stderr(values): unused argument (values)</code></pre>
</div>
<div class="incremental">
<p>Er … what? What does <code>stderr</code> do?</p>
<p><code>?stderr</code></p>
</div>
<hr />
<p>How do you calculate the standard error of the mean of a sample?</p>
<div class="incremental">
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" data-line-number="1"><span class="kw">sd</span>(values)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(values))</a></code></pre></div>
<pre><code>## [1] 0.4484541</code></pre>
<p>Do we want to type this each time, copy and paste the code each time?</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" data-line-number="1">values2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">30</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb329-2" data-line-number="2"><span class="kw">sd</span>(values2)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(values))</a></code></pre></div>
<pre><code>## [1] 3.162278</code></pre>
<p>This can lead to errors in writing, small incorrect parts.
It also leaves all the complexity to the reader, so it makes it harder to
understand when reading code - hard to notice small details.</p>
<p>Where do we save it, how do we share it?</p>
<p>Copy and pasting from a file is okay, but it takes up a lot more work/space.
We could email around a file of code chunks, or share on github.</p>
<p>How do we make sure it works?</p>
<p>This is hard to do with copy-paste code chunks. Changing the chunk to work
on a new input can be an opportunity for introducing errors, typos.</p>
</div>
<hr />
<div id="write-it-as-a-function" class="section level4">
<h4><span class="header-section-number">4.3.0.1</span> Write it as a function!</h4>
<p>What are the parameters? Are any defaults set?
What does it return?</p>
<p>These can be copy and pasted, or <code>source()</code>’d from a <code>.R</code> file.
Once you run it, you can test it and change inputs easily.
Later, you could change the function and keep the same script of using the
function.</p>
<div class="incremental">
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb331-1" data-line-number="1">sez &lt;-<span class="st"> </span><span class="cf">function</span>(x) {<span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(x))}</a>
<a class="sourceLine" id="cb331-2" data-line-number="2"><span class="kw">sez</span>(values)</a></code></pre></div>
<pre><code>## [1] 0.4484541</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb333-1" data-line-number="1"><span class="kw">sez</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>))</a></code></pre></div>
<pre><code>## [1] 0.223197</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb335-1" data-line-number="1"><span class="kw">sez</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>))</a></code></pre></div>
<pre><code>## [1] 0.1157716</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb337-1" data-line-number="1"><span class="kw">sez</span>(<span class="kw">rpois</span>(<span class="fl">1e3</span>,<span class="dv">3</span>))</a></code></pre></div>
<pre><code>## [1] 0.05433485</code></pre>
</div>
<hr />
</div>
</div>
<div id="using-functions-to-write-modular-code" class="section level2">
<h2><span class="header-section-number">4.4</span> Using functions to write modular code</h2>
<p>How might you carry out the workflow from the previous work to
calculate protein sequence lengths?</p>
<div class="incremental">
<p>One way is to flatten out all the tasks,
and to script each individual task each time.
This requires the author, user, and reader to understand a lot of complexity.</p>
<div class="mermaid">
graph TD
    classDef default line-height:10px;
    classDef three line-height:10px,fill:yellow;
    you[analyst] --> B[finding files] &    C[making a vector] &    D[looping] &    E[reading files] &    F[getting protein seq] &    G[calculting and saving nchar] &    H[plotting nchar]
    B:::three;
    C:::three;
    D:::three;
    E:::three;
    F:::three;
    G:::three;
    H:::three;
</div>
<p>Another way to approach this is to cluster them into a hierarchy of modules.</p>
<div class="mermaid">
graph TD
    classDef default line-height:10px;
    classDef one  line-height:10px,fill:pink;
    classDef two line-height:10px,fill:cyan;
    classDef three line-height:10px,fill:yellow;
    you2[analyst] --> find & read & plot;
    find:::one --> B;
    B[finding files]:::three;
    read:::one --> looping & reading;
    looping:::two --> C & D;
    C[making a vector]:::three;
    D[looping]:::three;
    reading[reading and calc]:::two --> E & F & G;
    E[reading files]:::three;
    F[getting protein seq]:::three;
    G[calculting and saving nchar]:::three;
    plot:::one --> H;
    H[plotting nchar]:::three;
</div>
<p>In this organization, the analyst can operate at levels of
<span style="color:magenta">steps</span>,
<span style="color:cyan">modules</span>, and
<span style="color:gold">specific instructions</span>,
depending on what is needed.</p>
</div>
<hr />
<p>Organizing your workflows into composable modules lets you extend these to
un-ancipiated complexity. You could imaging using these steps or modules:</p>
<div class="mermaid">
graph LR
    classDef default line-height:12px;
    vp[read viral proteins] --> cl[calculate lengths] --> hist[histogram]
</div>
<p>in new ways by composing the elements together, to analyze a different source
of proteins, with a new analysis, with similar plots:</p>
<div class="mermaid">
graph LR
    classDef default line-height:12px;
    vp[read viral proteins] --> cl[calculate lengths] --> hist[histogram]
    hp[read human proteins] --> cl --> boxplot[boxplot]
    vp --> cgc[calculate GC%] --> gchist[histogram]
    hp --> cgc --> gcboxplot[boxplot]
</div>
<hr />
<div id="tips-for-modular-workflows" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Tips for modular workflows</h3>
<ul>
<li><p>Try to not “hardcode” things - if it’s a number, consider if it can be a
<em>parameter</em> that is “passed in” as an argument.</p></li>
<li><p>Group repeated code functions - some folks say you should never repeat
code (but do what works for you!).</p></li>
<li><p>Try to read inputs and outputs as general, flexible formats -
strings of filenames, vectors of values</p></li>
<li><p>Write a comment at the top of the function that says what it’s doing
and what to expect, generally comment things.</p></li>
</ul>
<p>Consider, the <code>list.files()</code> and <code>hist()</code> functions are already built this way!
How about a <code>ggplot2</code> style boxplot?</p>
<hr />
<div id="lets-write-a-plotting-modulefunction" class="section level4">
<h4><span class="header-section-number">4.4.1.1</span> Let’s write a plotting module/function</h4>
<p>Write a function that makes a ggplot2 boxplot for some numbers.</p>
<p>What should the function take, what should it do?</p>
<p>What is “some numbers”?</p>
<p>What should it return?</p>
<pre><code>wrap it in `print(ggplot code)` or return the ggplot object as
a variable</code></pre>
<hr />
</div>
</div>
<div id="more-complex-workflow" class="section level3">
<h3><span class="header-section-number">4.4.2</span> More complex workflow</h3>
<p>Let’s write a simulation of viral evolution.</p>
<p>(could be a bad idea, considering….)</p>
<p>More examples/exercise</p>
<p>show a simulation of something…. genetic drift of a virus replicating?</p>
<p>lineage G1312F</p>
<p>exercise - wrap the entire analysis as a function</p>
<p>talk about ease of calling</p>
<p>ease of tweaking this</p>
<p>exercise - break into subfunctions, generate and plot</p>
<p>ease of changing models</p>
<hr />
</div>
<div id="apply-is-a-popular-tool" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Apply is a popular tool</h3>
<p>Apply is another common way of doing something over and over.
It is a very compact way to take pieces of a list, vector, dataframe, or matrix
and put them into a function. There are:</p>
<ul>
<li><code>apply</code> - for 2D objects</li>
<li><code>lapply</code> - for lists and vectors</li>
<li><code>sapply</code> - is <code>lapply</code> but with simplified returns</li>
<li><code>mapply</code> - is for combinations of multiple variables</li>
<li><code>replicate</code> - calls a function multiple times</li>
</ul>
<p>Some people <em>strongly</em> prefer coding this way. Here is an example:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb340-1" data-line-number="1">list_of_protein_files &lt;-<span class="st"> </span><span class="kw">lapply</span>(</a>
<a class="sourceLine" id="cb340-2" data-line-number="2">        <span class="kw">list.files</span>(<span class="st">&quot;data/viral_structural_proteins/&quot;</span>,<span class="dt">full.names=</span>T),</a>
<a class="sourceLine" id="cb340-3" data-line-number="3">        read.delim,</a>
<a class="sourceLine" id="cb340-4" data-line-number="4">        <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,<span class="dt">header=</span>F)</a></code></pre></div>
<p>These “apply” some “FUN” to some input variables, by taking each element or
slices of elements from input variables and putting them in as arguments
to the function being applied. They return odd things, often lists (<code>unlist()</code>).</p>
<hr />
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
mermaid.initialize({
    startOnLoad: false, // don't render initially, instead....
    logLevel: 3, // for debugging
});
function initMermaid(s) { 
  var diagrams = document.querySelectorAll('.mermaid');
  var i;
  for(i=0;i<diagrams.length;i++){
    if(diagrams[i].offsetWidth>0){
      mermaid.init(undefined, diagrams[i]);
    }
  }
}
initMermaid();
</script>

</div>
</div>
<div id="packages-are-chunks-of-code-and-sometimes-data" class="section level2">
<h2><span class="header-section-number">4.5</span> Packages are chunks of code (and sometimes data)</h2>
<p>Let’s take a look at your code from the last few days.
How would you share this with the other people in the course?</p>
<p>R, like other languages, is built on a package system - if you wrap up your
code in particular expected ways and put it in particular expected places,
it is very easy for others to get and use your code</p>
<p>Packages are
<a href="https://ourcodingclub.github.io/tutorials/writing-r-package/">said to be easy to make</a>,
but they’re very easy to use.</p>
<hr />
<div id="cran-is-the-canonical-r-package-resource" class="section level3">
<h3><span class="header-section-number">4.5.1</span> CRAN is the canonical R package resource</h3>
<p><a href="">CRAN</a></p>
<p>historical context</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb341-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;stringdist&quot;</span>)</a></code></pre></div>
<p>Call <code>library()</code> function, with an argument of the library name,
as a string.</p>
<ul>
<li>get the stringdist library, use it</li>
<li>get a new viz layer, use it</li>
</ul>
<hr />
</div>
<div id="github-is-a-common-place-for-sharing-code-in-development" class="section level3">
<h3><span class="header-section-number">4.5.2</span> github is a common place for sharing code in development</h3>
<p>Installing from github requires some different programming -
and there’s libraries with functions for this.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb342-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;devtools&quot;</span>)</a></code></pre></div>
<p>or <code>remotes</code>?</p>
<p>exercise - pull a package off github… ? maybe some sort of viz again?</p>
<p>Exercise - install a package from github and learn how to use it</p>
<ul>
<li><a href="https://github.com/ewenme/ghibli">Ghibli color palette</a></li>
<li><a href="https://github.com/rossdrucker/sportyR">Sports field plotting</a></li>
<li><a href="https://github.com/wilkelab/ggridges">Ridgeplots in ggplot2</a></li>
</ul>
<!-- remotes::install_github("wilkelab/ggridges" -->
<p>problems with this - security, eh</p>
<hr />
</div>
<div id="bioconductor-is-a-great-place-for-bio-related-packages" class="section level3">
<h3><span class="header-section-number">4.5.3</span> Bioconductor is a great place for bio-related packages 😬</h3>
<p><a href="">How to install Bioconductor</a></p>
<p>Scholars will know how to install Bioconductor package from CRAN</p>
<p>Scholars will know how to find and install packages from Bioconductor</p>
<p>explore the namespace for a package, ie ?packagename:: and TAB or ?packagename::</p>
<p>how to print out all the packages you have loaded</p>
<hr />
</div>
</div>
<div id="finding-more-help-and-documentation" class="section level2">
<h2><span class="header-section-number">4.6</span> Finding more help and documentation</h2>
<p>Need a problem</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb343-1" data-line-number="1">?geom_line</a></code></pre></div>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb344-1" data-line-number="1">?stringdist</a></code></pre></div>
<p>Objective X.X: Scholars will know how to get official docs ( ? ) and how to skim/read these</p>
<p>Objective X.X: Scholars will see how easy it is to use a search engine to try and find other answers</p>
<p>Objective X.X: Scholars will understand the intention of the Slack being a learning community, or something (set expectations about this)</p>
<p>Source up problems from the class?</p>
<p>Demo a weird plot idea, search for how to do it on stack overflow?</p>
<p>Maybe how to change the color of facet labels in a ggplot facet graph, that’s a bit tricky and demonstrates why base R is important…</p>
<hr />

</div>
<div id="reproducibile-sharing---more-rmarkdown-and" class="section level2">
<h2><span class="header-section-number">4.7</span> Reproducibile sharing - more <code>rmarkdown</code> and</h2>
<p>How are you saving your notes for this class?
<!-- rmd you better be... --></p>
<p>How do you usually save notes/code/instructions?</p>
<p>How do you share this with others?</p>
<div id="rmarkdown-package" class="section level3 tabset">
<h3><span class="header-section-number">4.7.1</span> rmarkdown package</h3>
<div id="background" class="section level4">
<h4><span class="header-section-number">4.7.1.1</span> Background</h4>
<p>The <code>rmarkdown</code> package was created by
<a href="https://www.rstudio.com/speakers/yihui-xie/">Yihui Xie</a>,
extending from previous work and ideas in
<code>knitr</code> and <code>sweave</code>.</p>
<p>It’s a way of mixing writing with code, such that
you can run the code and it makes a pretty doc
(and <a href="https://rmarkdown.rstudio.com/gallery.html">more</a>).</p>
<p>video1 overview
<!-- 
motivation / ie what it do
video1 background / broad context
yihui xie - grad student, wrote a bunch of packages, now works at Rstudio (pattern here…)
sweave -> knitr -> rmarkdown
how I’ve used it, how you could use it
--></p>
</div>
<div id="chunk-options" class="section level4">
<h4><span class="header-section-number">4.7.1.2</span> Chunk options</h4>
<p>You can set chunk-level options in an Rmd, for
each code chunk. Such as:</p>
<pre><code>```{r, name_of_chunk, cache=T, fig.width=3, fig.height=2, error=F, warning=F, fig.align=&quot;right&quot;}
x &lt;- 1:10
y &lt;- 1:10
plot(x,y)
```</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb346-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb346-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb346-3" data-line-number="3"><span class="kw">plot</span>(x,y)</a></code></pre></div>
<p><img src="560-rmarkdown-and-repro_files/figure-html/name_of_chunk-1.png" width="288" style="display: block; margin: auto 0 auto auto;" /></p>
<p>It is possible to enable figure captions.</p>
<p>video2 chunk options
<!--
how to cache=T
how to hide warnings/errors
how to change figure sizes
fig.align=”right”
--></p>
</div>
<div id="document-options" class="section level4">
<h4><span class="header-section-number">4.7.1.3</span> Document options</h4>
<p>You can set document-level options to. To do this,
you create what’s called a
<a href="yaml.org">YAML</a> header, like so:</p>
<pre><code>---
title: &quot;Titled&quot;
author: &quot;yours&quot;
---</code></pre>
<p>You need three hyphens to open and close it.
Put it at the very beginning. You can define
quite a few options, including <em>themes</em>,
like so:</p>
<pre><code>---
title: &quot;Titled&quot;
author: &quot;yours&quot;

---</code></pre>
<p>video3 head options
<!--title
authors
date, Sys.date
format …. slides !
*** themes **** &&%
--></p>
</div>
<div id="how-it-works-sort-of" class="section level4">
<h4><span class="header-section-number">4.7.1.4</span> How it works, sort of…</h4>
<p>video4 how it does what it’s doing
<!--what it’s doing behind the scenes - a diagram ( on paper )
code gets pulled out and run, top to bottom
--></p>
<p><code>rmarkdown</code> parses an Rmd file to extract out
the R code. It runs this, using the chunk and
other options to control this, then makes outputs
from different chunks (text and plots).
It then sticks the text and images into a
<code>markdown</code> document, and uses a program called
<code>pandoc</code> (included inside Rstudio) to turn that
into HTML, PDF, and/or slides.</p>
</div>
</div>
<div id="section" class="section level3 unnumbered">
<h3></h3>
</div>
<div id="sharing-with-others" class="section level3">
<h3><span class="header-section-number">4.7.2</span> Sharing with others</h3>
<p>What does someone need to re-run your analyses?</p>
<!-- R, Rstudio, packages, scripts -->
<ul>
<li>R (often Rstudio)</li>
<li>what packages you’re using</li>
<li></li>
</ul>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb349-1" data-line-number="1">devtools<span class="op">::</span><span class="kw">session_info</span>()</a></code></pre></div>
<pre><code>## Error in get(genname, envir = envir) : object &#39;testthat_print&#39; not found</code></pre>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────
##  setting  value                       
##  version  R version 4.0.2 (2020-06-22)
##  os       macOS  10.16                
##  system   x86_64, darwin17.0          
##  ui       X11                         
##  language (EN)                        
##  collate  en_US.UTF-8                 
##  ctype    en_US.UTF-8                 
##  tz       America/Los_Angeles         
##  date     2021-06-04                  
## 
## ─ Packages ───────────────────────────────────────────────────────────────────
##  package     * version    date       lib source                            
##  assertthat    0.2.1      2019-03-21 [2] CRAN (R 4.0.0)                    
##  bookdown      0.22       2021-04-22 [1] CRAN (R 4.0.2)                    
##  callr         3.7.0      2021-04-20 [1] CRAN (R 4.0.2)                    
##  cli           2.5.0      2021-04-26 [1] CRAN (R 4.0.2)                    
##  codetools     0.2-16     2018-12-24 [2] CRAN (R 4.0.2)                    
##  crayon        1.4.1      2021-02-08 [1] CRAN (R 4.0.2)                    
##  desc          1.2.0      2018-05-01 [2] CRAN (R 4.0.0)                    
##  devtools      2.3.2      2020-09-18 [1] CRAN (R 4.0.2)                    
##  digest        0.6.27     2020-10-24 [1] CRAN (R 4.0.2)                    
##  ellipsis      0.3.2      2021-04-29 [1] CRAN (R 4.0.2)                    
##  evaluate      0.14       2019-05-28 [2] CRAN (R 4.0.0)                    
##  fs            1.5.0      2020-07-31 [1] CRAN (R 4.0.2)                    
##  glue          1.4.2      2020-08-27 [1] CRAN (R 4.0.2)                    
##  htmltools     0.5.1.9000 2021-01-26 [1] Github (rstudio/htmltools@e7f0393)
##  knitr         1.30       2020-09-22 [1] CRAN (R 4.0.2)                    
##  lifecycle     1.0.0      2021-02-15 [1] CRAN (R 4.0.2)                    
##  magrittr      2.0.1      2020-11-17 [1] CRAN (R 4.0.2)                    
##  memoise       1.1.0      2017-04-21 [1] CRAN (R 4.0.2)                    
##  pkgbuild      1.1.0      2020-07-13 [1] CRAN (R 4.0.2)                    
##  pkgload       1.1.0      2020-05-29 [2] CRAN (R 4.0.0)                    
##  prettyunits   1.1.1      2020-01-24 [2] CRAN (R 4.0.0)                    
##  processx      3.5.2      2021-04-30 [1] CRAN (R 4.0.2)                    
##  ps            1.3.3      2020-05-08 [2] CRAN (R 4.0.0)                    
##  purrr         0.3.4      2020-04-17 [2] CRAN (R 4.0.0)                    
##  R6            2.5.0      2020-10-28 [1] CRAN (R 4.0.2)                    
##  remotes       2.2.0      2020-07-21 [1] CRAN (R 4.0.2)                    
##  rlang         0.4.10     2020-12-30 [1] CRAN (R 4.0.2)                    
##  rmarkdown     2.6        2020-12-14 [1] CRAN (R 4.0.2)                    
##  rprojroot     2.0.2      2020-11-15 [1] CRAN (R 4.0.2)                    
##  sessioninfo   1.1.1      2018-11-05 [1] CRAN (R 4.0.2)                    
##  stringi       1.5.3      2020-09-09 [1] CRAN (R 4.0.2)                    
##  stringr       1.4.0      2019-02-10 [2] CRAN (R 4.0.0)                    
##  testthat      2.3.2      2020-03-02 [2] CRAN (R 4.0.0)                    
##  usethis       2.0.0      2020-12-10 [1] CRAN (R 4.0.2)                    
##  withr         2.4.1      2021-01-26 [1] CRAN (R 4.0.2)                    
##  xfun          0.23       2021-05-15 [1] CRAN (R 4.0.2)                    
##  yaml          2.2.1      2020-02-01 [2] CRAN (R 4.0.0)                    
## 
## [1] /Users/melissako/Library/R/4.0/library
## [2] /Library/Frameworks/R.framework/Versions/4.0/Resources/library</code></pre>
<p>why the hell we want others to use our code?
Well I’ll tell you why - the general intellect</p>
<p>think about this</p>
<p>think about the next person coming along, or yourself in 3 months</p>
<p>links on syllabus for more info</p>
<p>all sorts of automated stuff you can do</p>
</div>
</div>
<div id="reproducibility-and-sharing" class="section level2">
<h2><span class="header-section-number">4.8</span> Reproducibility and sharing</h2>
<p>think about this</p>
<p>think about the next person coming along, or yourself in 3 months</p>
<p>links on syllabus for more info</p>
<p>all sorts of automated stuff you can do</p>

</div>
<div id="troubleshooting-getting-help-dissecting-problems" class="section level2">
<h2><span class="header-section-number">4.9</span> Troubleshooting, getting help, dissecting problems</h2>
<p>You will have problems.</p>
<p>How do you (1) get past these and (2) learn from them?</p>
<p>What kinds of errors did we encounter in this class?</p>
<p>How do we deal with these?</p>
<div id="places-to-look-for-help" class="section level3">
<h3><span class="header-section-number">4.9.1</span> Places to look for help</h3>
<ul>
<li>yourself - past notes, troubleshoot logically</li>
<li>the people around you, research mentors</li>
<li>Slack channel</li>
<li>github/gitlab “Issues” page - search first the closed issues!!!</li>
<li>StackOverflow - search first for similar problems!!!</li>
<li>twitter (for fun problems)</li>
</ul>
<p>It helps to have a…</p>
</div>
<div id="minimum-reproducible-example" class="section level3">
<h3><span class="header-section-number">4.9.2</span> Minimum reproducible example</h3>
<p>video1
<!--
show an error, simplify it by making MRE
--></p>
<p>If you can’t find an easy answer, it is important to begin to approach the
problem like you would a science problem.</p>
<p>Reduce the problem, eliminate extraneous variables.</p>
<p>Use or capture intermediate steps to identify where the issue is.</p>
<p>Collect <code>sessionInfo()</code> and share it with folks.</p>
<!-- maybe not....
### Exercise - debug one of the following Rmds
-->

</div>
</div>
<div id="conclusion-other-concepts" class="section level2">
<h2><span class="header-section-number">4.10</span> Conclusion, other concepts</h2>
<p>Today we covered:</p>
<ul>
<li>loops to repeat code</li>
<li>aspects of nice (re)usable code</li>
<li>writing code modularly with functions</li>
<li>finding and using packages</li>
<li>writing an Rmarkdown report</li>
<li>finding help and tackling a complex problem</li>
</ul>
<p>We hope you are better oriented and prepared to
repeat your analyses to build a complete story,
reproduce these larger analyses workflows,
extend from your work to do more complicated
workflows,
and share your analyses with others in a
well-organized but complete way.</p>
<p>You can extend on these ideas. Here’s a couple of
areas that might be useful:</p>
<dl>
<dt>Workflow / pipeline tools</dt>
<dd><p>These are automation tools to smartly run
different chunks of analyses. This is really
handy when parts of your workflow take a
long time, and you usually don’t want to be<br />
re-running those, but you do want it to be
able to run the whole thing automatically.</p>
<p>You can use old-school shell-like tools such
as “<a href="https://makefiletutorial.com/">Make/Makefiles</a>”,
newfangled but complex tools
like “Nextflow”
or “snakemake”,
or R-specific tooks like
“<a href="https://books.ropensci.org/targets/walkthrough.html">targets</a>”.</p>
</dd>
</dl>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Ask Darach if you want details, or <a href="doi.org/10.7554/eLife.62365">read the paper</a><a href="day-5-building-workflows.html#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
<p style="margin-top:10em;text-align:center;font-size:small;">
    <a href="https://github.com/darachm/dll-r/blob/main/LICENSE.md">
        Licensed Creative Commons Attribution-NonCommercial-ShareAlike 4.0
    </a>
</p>
<p style="text-align:center;font-size:small;">
    <a href="https://github.com/rstudio/bookdown" target="blank">
        Website typeset with bookdown
    </a>
</p>

<script> 
// This is to look through, everything that's a floating lone double dash,
// delete it. This is left over for stuff that's trying to be pauses for
// the slides
var listz = document.getElementsByTagName("p");
for (var i=0; i < listz.length; i++) { 
    if (listz[i].innerText === "–") { listz[i].innerText = "" } 
} 
</script>
            </section>

          </div>
        </div>
      </div>
<a href="day-4-tidyverse-and-visualizations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/darachm/dll-r/edit/main/500-day5-intro.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DLL 2021 R syllabus site.html"],
"toc": {
"collapse": "subsection"
},
"highlight": "zenburn"
});
});
</script>

</body>

</html>
