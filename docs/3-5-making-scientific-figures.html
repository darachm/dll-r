<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.5 Making scientific figures | DLL 2021, R section</title>
  <meta name="description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="3.5 Making scientific figures | DLL 2021, R section" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  <meta name="github-repo" content="darachm/dll-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.5 Making scientific figures | DLL 2021, R section" />
  
  <meta name="twitter:description" content="A living syllabus for the R section of DLL 2021, at Stanford" />
  

<meta name="author" content="mesako" />
<meta name="author" content="Margaret" />
<meta name="author" content="Samson" />
<meta name="author" content="Zac" />
<meta name="author" content="darachm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="3-4-making-plots-with-ggplot2.html"/>
<link rel="next" href="3-6-applying-basic-stats.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DLL 2021 R workshops</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Workshop introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="1-1-workshop-goals.html"><a href="1-1-workshop-goals.html"><i class="fa fa-check"></i><b>1.1</b> Workshop goals</a></li>
<li class="chapter" data-level="1.2" data-path="1-2-structure-and-resources.html"><a href="1-2-structure-and-resources.html"><i class="fa fa-check"></i><b>1.2</b> Structure and resources</a><ul>
<li class="chapter" data-level="1.2.1" data-path="1-2-structure-and-resources.html"><a href="1-2-structure-and-resources.html#this-syllabus-and-videos"><i class="fa fa-check"></i><b>1.2.1</b> This syllabus and videos</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-2-structure-and-resources.html"><a href="1-2-structure-and-resources.html#slack-channel"><i class="fa fa-check"></i><b>1.2.2</b> Slack channel</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1-3-workshop-expectations.html"><a href="1-3-workshop-expectations.html"><i class="fa fa-check"></i><b>1.3</b> Workshop expectations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-day-3-intoduction-to-r.html"><a href="2-day-3-intoduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Day 3 - intoduction to R</a><ul>
<li class="chapter" data-level="2.1" data-path="2-1-navigating-rstudio.html"><a href="2-1-navigating-rstudio.html"><i class="fa fa-check"></i><b>2.1</b> Navigating Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="2-2-using-rmds.html"><a href="2-2-using-rmds.html"><i class="fa fa-check"></i><b>2.2</b> Using Rmds</a></li>
<li class="chapter" data-level="2.3" data-path="2-3-getting-started-in-r.html"><a href="2-3-getting-started-in-r.html"><i class="fa fa-check"></i><b>2.3</b> Getting started in R</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-3-getting-started-in-r.html"><a href="2-3-getting-started-in-r.html#getting-help-in-r"><i class="fa fa-check"></i><b>2.3.1</b> Getting help in R</a></li>
<li class="chapter" data-level="2.3.2" data-path="2-3-getting-started-in-r.html"><a href="2-3-getting-started-in-r.html#using-variables-and-data-types"><i class="fa fa-check"></i><b>2.3.2</b> Using variables and data types</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-3-getting-started-in-r.html"><a href="2-3-getting-started-in-r.html#using-functions"><i class="fa fa-check"></i><b>2.3.3</b> Using functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-4-working-with-vectors.html"><a href="2-4-working-with-vectors.html"><i class="fa fa-check"></i><b>2.4</b> Working with vectors</a><ul>
<li class="chapter" data-level="2.4.1" data-path="2-4-working-with-vectors.html"><a href="2-4-working-with-vectors.html#building-vectors"><i class="fa fa-check"></i><b>2.4.1</b> Building vectors</a></li>
<li class="chapter" data-level="2.4.2" data-path="2-4-working-with-vectors.html"><a href="2-4-working-with-vectors.html#indexing-and-subsetting-vectors"><i class="fa fa-check"></i><b>2.4.2</b> Indexing and subsetting vectors</a></li>
<li class="chapter" data-level="2.4.3" data-path="2-4-working-with-vectors.html"><a href="2-4-working-with-vectors.html#using-logic-and-logicals"><i class="fa fa-check"></i><b>2.4.3</b> Using logic and logicals</a></li>
<li class="chapter" data-level="2.4.4" data-path="2-4-working-with-vectors.html"><a href="2-4-working-with-vectors.html#modifying-vectors"><i class="fa fa-check"></i><b>2.4.4</b> Modifying vectors</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-5-working-with-dataframes.html"><a href="2-5-working-with-dataframes.html"><i class="fa fa-check"></i><b>2.5</b> Working with dataframes</a><ul>
<li class="chapter" data-level="2.5.1" data-path="2-5-working-with-dataframes.html"><a href="2-5-working-with-dataframes.html#indexing-and-subsetting-dataframes"><i class="fa fa-check"></i><b>2.5.1</b> Indexing and subsetting dataframes</a></li>
<li class="chapter" data-level="2.5.2" data-path="2-5-working-with-dataframes.html"><a href="2-5-working-with-dataframes.html#exploring-dataframes"><i class="fa fa-check"></i><b>2.5.2</b> Exploring dataframes</a></li>
<li class="chapter" data-level="2.5.3" data-path="2-5-working-with-dataframes.html"><a href="2-5-working-with-dataframes.html#building-and-modifying-dataframes"><i class="fa fa-check"></i><b>2.5.3</b> Building and modifying dataframes</a></li>
<li class="chapter" data-level="2.5.4" data-path="2-5-working-with-dataframes.html"><a href="2-5-working-with-dataframes.html#handling-datatypes-in-dataframes"><i class="fa fa-check"></i><b>2.5.4</b> Handling datatypes in dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-day-4-tidyverse-and-visualizations.html"><a href="3-day-4-tidyverse-and-visualizations.html"><i class="fa fa-check"></i><b>3</b> Day 4 - tidyverse and visualizations</a><ul>
<li class="chapter" data-level="3.1" data-path="3-1-reading-and-processing-data.html"><a href="3-1-reading-and-processing-data.html"><i class="fa fa-check"></i><b>3.1</b> Reading and processing data</a></li>
<li class="chapter" data-level="3.2" data-path="3-2-using-tidyverse.html"><a href="3-2-using-tidyverse.html"><i class="fa fa-check"></i><b>3.2</b> Using tidyverse</a></li>
<li class="chapter" data-level="3.3" data-path="3-3-using-tidyverse-1.html"><a href="3-3-using-tidyverse-1.html"><i class="fa fa-check"></i><b>3.3</b> Using tidyverse</a></li>
<li class="chapter" data-level="3.4" data-path="3-4-making-plots-with-ggplot2.html"><a href="3-4-making-plots-with-ggplot2.html"><i class="fa fa-check"></i><b>3.4</b> Making plots with ggplot2</a><ul>
<li class="chapter" data-level="3.4.1" data-path="3-4-making-plots-with-ggplot2.html"><a href="3-4-making-plots-with-ggplot2.html#getting-started-with-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Getting started with a ggplot</a></li>
<li class="chapter" data-level="3.4.2" data-path="3-4-making-plots-with-ggplot2.html"><a href="3-4-making-plots-with-ggplot2.html#changing-plot-aesthetics"><i class="fa fa-check"></i><b>3.4.2</b> Changing plot aesthetics</a></li>
<li class="chapter" data-level="3.4.3" data-path="3-4-making-plots-with-ggplot2.html"><a href="3-4-making-plots-with-ggplot2.html#exploring-other-plots"><i class="fa fa-check"></i><b>3.4.3</b> Exploring other plots</a></li>
<li class="chapter" data-level="3.4.4" data-path="3-4-making-plots-with-ggplot2.html"><a href="3-4-making-plots-with-ggplot2.html#using-categorical-data"><i class="fa fa-check"></i><b>3.4.4</b> Using categorical data</a></li>
<li class="chapter" data-level="3.4.5" data-path="3-4-making-plots-with-ggplot2.html"><a href="3-4-making-plots-with-ggplot2.html#visualizing-between-groups"><i class="fa fa-check"></i><b>3.4.5</b> Visualizing between groups</a></li>
<li class="chapter" data-level="3.4.6" data-path="3-4-making-plots-with-ggplot2.html"><a href="3-4-making-plots-with-ggplot2.html#generating-heatmaps"><i class="fa fa-check"></i><b>3.4.6</b> Generating heatmaps</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-5-making-scientific-figures.html"><a href="3-5-making-scientific-figures.html"><i class="fa fa-check"></i><b>3.5</b> Making scientific figures</a><ul>
<li class="chapter" data-level="3.5.1" data-path="3-5-making-scientific-figures.html"><a href="3-5-making-scientific-figures.html#plotting-error-bars"><i class="fa fa-check"></i><b>3.5.1</b> Plotting error bars</a></li>
<li class="chapter" data-level="3.5.2" data-path="3-5-making-scientific-figures.html"><a href="3-5-making-scientific-figures.html#showing-trends-in-data"><i class="fa fa-check"></i><b>3.5.2</b> Showing trends in data</a></li>
<li class="chapter" data-level="3.5.3" data-path="3-5-making-scientific-figures.html"><a href="3-5-making-scientific-figures.html#saving-figures-locally"><i class="fa fa-check"></i><b>3.5.3</b> Saving figures locally</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="3-6-applying-basic-stats.html"><a href="3-6-applying-basic-stats.html"><i class="fa fa-check"></i><b>3.6</b> Applying basic stats</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-day-5-building-workflows.html"><a href="4-day-5-building-workflows.html"><i class="fa fa-check"></i><b>4</b> Day 5 - building workflows</a><ul>
<li class="chapter" data-level="4.1" data-path="4-1-using-code-many-times-loops.html"><a href="4-1-using-code-many-times-loops.html"><i class="fa fa-check"></i><b>4.1</b> Using code many times - loops</a><ul>
<li class="chapter" data-level="4.1.1" data-path="4-1-using-code-many-times-loops.html"><a href="4-1-using-code-many-times-loops.html#doing-things-multiple-times"><i class="fa fa-check"></i><b>4.1.1</b> Doing things multiple times</a></li>
<li class="chapter" data-level="4.1.2" data-path="4-1-using-code-many-times-loops.html"><a href="4-1-using-code-many-times-loops.html#loops"><i class="fa fa-check"></i><b>4.1.2</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-2-writing-reusable-code.html"><a href="4-2-writing-reusable-code.html"><i class="fa fa-check"></i><b>4.2</b> Writing (re)usable code</a><ul>
<li class="chapter" data-level="4.2.1" data-path="4-2-writing-reusable-code.html"><a href="4-2-writing-reusable-code.html#style-guides-can-be-inspiring"><i class="fa fa-check"></i><b>4.2.1</b> Style guides can be inspiring</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4-3-functions-redux-why-theyre-so-great.html"><a href="4-3-functions-redux-why-theyre-so-great.html"><i class="fa fa-check"></i><b>4.3</b> Functions redux - why they’re so great</a></li>
<li class="chapter" data-level="4.4" data-path="4-4-using-functions-to-write-modular-code.html"><a href="4-4-using-functions-to-write-modular-code.html"><i class="fa fa-check"></i><b>4.4</b> Using functions to write modular code</a><ul>
<li class="chapter" data-level="4.4.1" data-path="4-4-using-functions-to-write-modular-code.html"><a href="4-4-using-functions-to-write-modular-code.html#tips-for-modular-workflows"><i class="fa fa-check"></i><b>4.4.1</b> Tips for modular workflows</a></li>
<li class="chapter" data-level="4.4.2" data-path="4-4-using-functions-to-write-modular-code.html"><a href="4-4-using-functions-to-write-modular-code.html#more-complex-workflow"><i class="fa fa-check"></i><b>4.4.2</b> More complex workflow</a></li>
<li class="chapter" data-level="4.4.3" data-path="4-4-using-functions-to-write-modular-code.html"><a href="4-4-using-functions-to-write-modular-code.html#apply-is-a-popular-tool"><i class="fa fa-check"></i><b>4.4.3</b> Apply is a popular tool</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="4-5-packages-are-chunks-of-code-and-sometimes-data.html"><a href="4-5-packages-are-chunks-of-code-and-sometimes-data.html"><i class="fa fa-check"></i><b>4.5</b> Packages are chunks of code (and sometimes data)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="4-5-packages-are-chunks-of-code-and-sometimes-data.html"><a href="4-5-packages-are-chunks-of-code-and-sometimes-data.html#cran-is-the-canonical-r-package-resource"><i class="fa fa-check"></i><b>4.5.1</b> CRAN is the canonical R package resource</a></li>
<li class="chapter" data-level="4.5.2" data-path="4-5-packages-are-chunks-of-code-and-sometimes-data.html"><a href="4-5-packages-are-chunks-of-code-and-sometimes-data.html#github-is-a-common-place-for-sharing-code-in-development"><i class="fa fa-check"></i><b>4.5.2</b> github is a common place for sharing code in development</a></li>
<li class="chapter" data-level="4.5.3" data-path="4-5-packages-are-chunks-of-code-and-sometimes-data.html"><a href="4-5-packages-are-chunks-of-code-and-sometimes-data.html#bioconductor-is-a-great-place-for-bio-related-packages"><i class="fa fa-check"></i><b>4.5.3</b> Bioconductor is a great place for bio-related packages 😬</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="4-6-finding-more-help-and-documentation.html"><a href="4-6-finding-more-help-and-documentation.html"><i class="fa fa-check"></i><b>4.6</b> Finding more help and documentation</a></li>
<li class="chapter" data-level="4.7" data-path="4-7-reproducibile-sharing-more-rmarkdown-and.html"><a href="4-7-reproducibile-sharing-more-rmarkdown-and.html"><i class="fa fa-check"></i><b>4.7</b> Reproducibile sharing - more <code>rmarkdown</code> and</a><ul>
<li class="chapter" data-level="4.7.1" data-path="4-7-reproducibile-sharing-more-rmarkdown-and.html"><a href="4-7-reproducibile-sharing-more-rmarkdown-and.html#rmarkdown-package"><i class="fa fa-check"></i><b>4.7.1</b> rmarkdown package</a></li>
<li><a href="4-7-reproducibile-sharing-more-rmarkdown-and.html#section"></a></li>
<li class="chapter" data-level="4.7.2" data-path="4-7-reproducibile-sharing-more-rmarkdown-and.html"><a href="4-7-reproducibile-sharing-more-rmarkdown-and.html#sharing-with-others"><i class="fa fa-check"></i><b>4.7.2</b> Sharing with others</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="4-8-reproducibility-and-sharing.html"><a href="4-8-reproducibility-and-sharing.html"><i class="fa fa-check"></i><b>4.8</b> Reproducibility and sharing</a></li>
<li class="chapter" data-level="4.9" data-path="4-9-troubleshooting-getting-help-dissecting-problems.html"><a href="4-9-troubleshooting-getting-help-dissecting-problems.html"><i class="fa fa-check"></i><b>4.9</b> Troubleshooting, getting help, dissecting problems</a><ul>
<li class="chapter" data-level="4.9.1" data-path="4-9-troubleshooting-getting-help-dissecting-problems.html"><a href="4-9-troubleshooting-getting-help-dissecting-problems.html#places-to-look-for-help"><i class="fa fa-check"></i><b>4.9.1</b> Places to look for help</a></li>
<li class="chapter" data-level="4.9.2" data-path="4-9-troubleshooting-getting-help-dissecting-problems.html"><a href="4-9-troubleshooting-getting-help-dissecting-problems.html#minimum-reproducible-example"><i class="fa fa-check"></i><b>4.9.2</b> Minimum reproducible example</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="4-10-conclusion-other-concepts.html"><a href="4-10-conclusion-other-concepts.html"><i class="fa fa-check"></i><b>4.10</b> Conclusion, other concepts</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-appendix.html"><a href="5-appendix.html"><i class="fa fa-check"></i><b>5</b> Appendix</a><ul>
<li class="chapter" data-level="5.1" data-path="5-1-additional-tutorials.html"><a href="5-1-additional-tutorials.html"><i class="fa fa-check"></i><b>5.1</b> Additional tutorials</a><ul>
<li class="chapter" data-level="5.1.1" data-path="5-1-additional-tutorials.html"><a href="5-1-additional-tutorials.html#sub-sub-section"><i class="fa fa-check"></i><b>5.1.1</b> sub sub section</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-2-more-challenges.html"><a href="5-2-more-challenges.html"><i class="fa fa-check"></i><b>5.2</b> More challenges</a></li>
<li class="chapter" data-level="5.3" data-path="5-3-figures-ideas.html"><a href="5-3-figures-ideas.html"><i class="fa fa-check"></i><b>5.3</b> Figures ideas</a></li>
<li class="chapter" data-level="5.4" data-path="5-4-rmd-example-of-code-chunk.html"><a href="5-4-rmd-example-of-code-chunk.html"><i class="fa fa-check"></i><b>5.4</b> Rmd example of code chunk</a></li>
<li class="chapter" data-level="5.5" data-path="5-5-more-example-rmds.html"><a href="5-5-more-example-rmds.html"><i class="fa fa-check"></i><b>5.5</b> More example Rmds</a></li>
<li class="chapter" data-level="5.6" data-path="5-6-how-to-edit-this-document.html"><a href="5-6-how-to-edit-this-document.html"><i class="fa fa-check"></i><b>5.6</b> How to edit this document</a><ul>
<li class="chapter" data-level="5.6.1" data-path="5-6-how-to-edit-this-document.html"><a href="5-6-how-to-edit-this-document.html#setup"><i class="fa fa-check"></i><b>5.6.1</b> Setup</a></li>
<li class="chapter" data-level="5.6.2" data-path="5-6-how-to-edit-this-document.html"><a href="5-6-how-to-edit-this-document.html#editwork-on-it"><i class="fa fa-check"></i><b>5.6.2</b> Edit/work on it</a></li>
<li class="chapter" data-level="5.6.3" data-path="5-6-how-to-edit-this-document.html"><a href="5-6-how-to-edit-this-document.html#publishing-onto-the-main-page-so-its-hosted-at-the-url"><i class="fa fa-check"></i><b>5.6.3</b> Publishing onto the main page, so it’s hosted at the URL</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="5-7-more-links.html"><a href="5-7-more-links.html"><i class="fa fa-check"></i><b>5.7</b> More links</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DLL 2021, R section</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="making-scientific-figures" class="section level2">
<h2><span class="header-section-number">3.5</span> Making scientific figures</h2>
<p>Making plots can be a great way to develop an intuition for your dataset, though to derive and communicate scientific insights, we need to have an idea of the uncertainty in our interpretations.</p>
<p>Uncertainty describes ideas such as: are the values between two groups different enough, that it is unlikely that the differences are due to chance? Is the correlation between these variables strong enough that one can predict the other, with some level of confidence? <em>How statistically significant are the patterns we see?</em></p>
<div id="plotting-error-bars" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Plotting error bars</h3>
<p>When we compare measurements taken from two samples (i.e. two groups), we might want to see if the two groups have very different values for that specific measurement. If we have multiple observations within each group, we can take a summary statistic such as the mean or median and plot those against each other.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" title="1"><span class="kw">ggplot</span>(msleep2, <span class="kw">aes</span>(<span class="dt">x =</span> vore, <span class="dt">y =</span> awake)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb218-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">fun =</span> <span class="st">&quot;mean&quot;</span>)</a></code></pre></div>
<p><img src="450-scientific-figures_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>For example, here we have asked our <code>geom_bar</code> function to plot a summary, specifically the mean of each group, instead of plotting <code>identity</code> which usually means the value as is. Looking at this figure, we can’t guess if the groups are significantly different without an idea of the uncertainty in our measurements through something like error bars.
Here is the convention for plotting error bars in ggplot2, as you can see it is just another kind of geom that we can add to our plot:</p>
<p><code>ggplot(data = &lt;SUMMARY DATA&gt;, mapping = aes(&lt;SUMMARY MAPPINGS&gt;) + geom_bar(stat = "identity") + geom_errorbar(aes(&lt;ERROR MAPPINGS&gt;))</code></p>
<p>This method is straightforward, but you need to have pre-calculated the summary statistic for each group and the amount of error (i.e. standard error) from your data. That “aggregated” dataframe becomes the data that you provide to ggplot, instead of the original dataset.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" title="1">feeding.data &lt;-<span class="st"> </span>msleep2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(vore) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb219-2" title="2"><span class="st">  </span><span class="kw">summarize</span>(<span class="kw">mean_se</span>(awake))</a></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" title="1">feeding.data</a></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   vore        y  ymin  ymax
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 carni   13.6  12.6   14.7
## 2 herbi   14.5  13.6   15.4
## 3 insecti  9.06  6.41  11.7
## 4 omni    13.1  12.4   13.7
## 5 &lt;NA&gt;    13.8  12.7   14.9</code></pre>
<p>What does mean_se do?
?mean_se
y is the mean
ymin is mean - one SE
ymax is mean + one SE</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" title="1"><span class="kw">ggplot</span>(feeding.data, <span class="kw">aes</span>(<span class="dt">x =</span> vore, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb223-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)</a></code></pre></div>
<p><img src="450-scientific-figures_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Here we create the same plot as before from this aggregated dataset, just showing the mean value in each group.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" title="1"><span class="kw">ggplot</span>(feeding.data, <span class="kw">aes</span>(<span class="dt">x =</span> vore, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb224-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb224-3" title="3"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> ymin, <span class="dt">ymax =</span> ymax),</a>
<a class="sourceLine" id="cb224-4" title="4">                <span class="dt">width =</span> <span class="fl">0.2</span>)</a></code></pre></div>
<p><img src="450-scientific-figures_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Now we add the error bars, mapping the <code>ymin</code> and <code>ymax</code> values to show where the bottom and top of each error bar should be.</p>
<hr />
</div>
<div id="showing-trends-in-data" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Showing trends in data</h3>
<p>Lots of these different figures summarize or aggregate the data. We may want to display the data with the individual points, but still show the overall trend across the data.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1">msleep3 &lt;-<span class="st"> </span>msleep2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">bodywt_log =</span> <span class="kw">log</span>(bodywt))</a>
<a class="sourceLine" id="cb225-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> msleep3, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> brainwt_log, <span class="dt">y =</span> bodywt_log)) <span class="op">+</span></a>
<a class="sourceLine" id="cb225-3" title="3"><span class="st">  </span><span class="kw">geom_density_2d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb225-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="450-scientific-figures_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span></a>
<a class="sourceLine" id="cb226-2" title="2"><span class="st">  </span><span class="kw">geom_density_2d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb226-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="450-scientific-figures_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>We can add a trendline with <code>geom_smooth</code> that you can check using <code>help(geom_smooth)</code>.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1">my.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(msleep3, <span class="kw">aes</span>(<span class="dt">x =</span> brainwt_log, <span class="dt">y =</span> bodywt_log)) <span class="op">+</span></a>
<a class="sourceLine" id="cb227-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb227-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>()</a>
<a class="sourceLine" id="cb227-4" title="4">my.plot</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="450-scientific-figures_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>We can also do this with trendlines that summarize only certain subsets of the data, such as ?</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb229-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb229-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Species)) </a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="450-scientific-figures_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>The above plot reflects the trends, but makes it hard to see the data that is contributing to each trend line. These differences can be most easily seen using <code>facet_wrap</code> or facetting that splits the figure into separate panel where the data has been filtered by the category (i.e. ?).</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> iris, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span></a>
<a class="sourceLine" id="cb231-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb231-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Species)) <span class="op">+</span></a>
<a class="sourceLine" id="cb231-4" title="4"><span class="st">  </span><span class="kw">facet_wrap</span>( <span class="op">~</span><span class="st"> </span>Species)</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="450-scientific-figures_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<hr />
</div>
<div id="saving-figures-locally" class="section level3">
<h3><span class="header-section-number">3.5.3</span> Saving figures locally</h3>
<p>As you produce analysis in your research, you may want to create high-quality images of your figures to then use in presentations or publications. There are two easy ways to save images as an individual file on your computer,</p>
<p>The first method uses <code>ggsave</code> to save the most recent ggplot figure you generated.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" title="1"><span class="kw">ggplot</span>(msleep2, <span class="kw">aes</span>(<span class="dt">x =</span> brainwt_log, <span class="dt">y =</span> sleep_rem)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb233-2" title="2"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</a>
<a class="sourceLine" id="cb233-3" title="3"><span class="kw">ggsave</span>(<span class="st">&quot;plot.png&quot;</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">height =</span> <span class="dv">5</span>)</a></code></pre></div>
<p>This function will save wherever your directory is currently. Check with <code>getwd()</code> and change with <code>setwd(folder name)</code>. You can also provide a precise file path in the new file name.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1"><span class="kw">ggsave</span>(<span class="st">&quot;~/Downloads/plot.png&quot;</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">height =</span> <span class="dv">5</span>)</a></code></pre></div>
<p>Here is an alternative method for saving your figures:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" title="1"><span class="kw">pdf</span>(<span class="st">&quot;plot.pdf&quot;</span>) <span class="co"># creates the file</span></a>
<a class="sourceLine" id="cb235-2" title="2"><span class="co"># png() also works if you want a different file format</span></a>
<a class="sourceLine" id="cb235-3" title="3"><span class="kw">ggplot</span>(msleep2, <span class="kw">aes</span>(<span class="dt">x =</span> brainwt_log, <span class="dt">y =</span> sleep_rem)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb235-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</a>
<a class="sourceLine" id="cb235-5" title="5"><span class="kw">dev.off</span>() <span class="co"># finishes editing the file</span></a></code></pre></div>
<p>Any changes to the figure that are contained between the initial creation of the figure (i.e. the <code>pdf</code> command) and the <code>dev.off</code> command will be included in the final saved image. However, the figure is being printed directly to the file it is writing and won’t appear elsewhere.</p>

</div>
</div>
<p style="margin-top:10em;text-align:center;font-size:small;">
    <a href="https://github.com/darachm/dll-r/blob/main/LICENSE.md">
        Licensed Creative Commons Attribution-NonCommercial-ShareAlike 4.0
    </a>
</p>
<p style="text-align:center;font-size:small;">
    <a href="https://github.com/rstudio/bookdown" target="blank">
        Website typeset with bookdown
    </a>
</p>

<script> 
// This is to look through, everything that's a floating lone double dash,
// delete it. This is left over for stuff that's trying to be pauses for
// the slides
var listz = document.getElementsByTagName("p");
for (var i=0; i < listz.length; i++) { 
    if (listz[i].innerText === "–") { listz[i].innerText = "" } 
} 
</script>
            </section>

          </div>
        </div>
      </div>
<a href="3-4-making-plots-with-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="3-6-applying-basic-stats.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/darachm/dll-r/edit/main/450-scientific-figures.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DLL 2021 R syllabus site.html"],
"toc": {
"collapse": "subsection"
},
"highlight": "zenburn"
});
});
</script>

</body>

</html>
