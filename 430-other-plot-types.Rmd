## Plotting Numerical vs. Categorical Data

```{r,ggplot2,echo=FALSE}
library(ggplot2)
library(tidyverse)
msleep2 <- msleep %>% mutate(brainwt_log = log(brainwt))
```

We can create histograms in ggplot2 that are more aesthetically pleasing than the default `hist` function.

```{r}
ggplot(msleep, aes(x = sleep_total)) +
    geom_histogram(bins = 10)
```

By adding a different parameter to `fill` in the `aes` we define throgh the `ggplot` function, we can separate out histograms according to different groupings such as here where we look at how total sleep distribution is distributed according to feeding behavior.

```{r}
ggplot(msleep, aes(x = sleep_total, fill = vore)) +
    geom_histogram(bins = 10)
```

We can look at how many individuals in the dataset fall into each category, such as feeding behavior.

```{r}
ggplot(data = msleep, aes(x = vore)) + 
  geom_bar()
```

We can look at how many total sleep distribution is distributed within each category of feeding behavior using separate box plots.

```{r}
ggplot(data = msleep, aes(x = vore, y = sleep_total)) + 
  geom_boxplot()
```

We can even drill down further and separate out another category, so that we can look at each feeding behavior and each conservation status (e.g. how the total sleep duration of domesticated herbivores compares to least concern carnivores).

```{r}
ggplot(msleep, aes(x = vore, y = sleep_total, color = conservation)) +
    geom_boxplot() 
```

------

### Plotting Error Bars

Discrete Variables
ggplot(msleep2, aes(x = vore, y = awake)) + 
  geom_bar(stat = "identity") 

ggplot(msleep2, aes(x = vore, y = awake)) + 
  geom_bar(stat = "summary", fun = "median")

Error Bars
ggplot(df, aes(x,y)) + geom_bar(blahblah) + geom_errorbar()
you could do this, but then you need to have pre-calculated
the mean value for each group and the SE in your data

feeding.data <- msleep2 %>% group_by(vore) %>% 
  summarize(mean_se(awake))
feeding.data

What does mean_se do?
?mean_se
y is the mean
ymin is mean - one SE
ymax is mean + one SE

ggplot(feeding.data, aes(x = vore, y = y)) + 
  geom_bar(stat = "identity")

ggplot(feeding.data, aes(x = vore, y = y)) + 
  geom_bar(stat = "identity") + 
  geom_errorbar(aes(ymin = ymin, ymax = ymax),
                width = 0.2)

------

### Plotting Trends in Big Data

Lots of these different figures summarize or aggregate the data. We may want to display the data with the individual points, but still show the overall trend across the data.

```{r, warning=FALSE}
ggplot(data = msleep2, mapping = aes(x = brainwt_log, y = sleep_rem)) +
    geom_bin2d() +
    geom_density_2d() +
    geom_point()
```

We can add a trendline with `geom_smooth` that you can check using `help(geom_smooth)`.

```{r, warning=FALSE}
ggplot(data = msleep2, mapping = aes(x = brainwt_log, y = sleep_rem)) +
    geom_point(alpha = 0.5) +
    geom_smooth()

msleep3 <- msleep2 %>% mutate(bodywt_log = log(bodywt))

my.plot <- ggplot(msleep3, aes(x = brainwt_log, y = bodywt_log)) + 
  geom_point()
my.plot

```

We can also do this with trendlines that summarize only certain subsets of the data, such as ?

```{r, warning=FALSE}
ggplot(data = msleep2, mapping = aes(x = brainwt_log, y = sleep_rem)) +
    geom_smooth(aes(color = vore)) 
```

The above plot reflects the trends, but makes it hard to see the data that is contributing to each trend line. These differences can be most easily seen using `facet_wrap` or facetting that splits the figure into separate panel where the data has been filtered by the category (i.e. ?).

```{r, warning=FALSE}
ggplot(data = msleep2, mapping = aes(x = brainwt_log, y = sleep_rem)) +
    geom_point() +
    geom_smooth(aes(color = vore)) +
    facet_wrap( ~ vore)
```

------

### Saving Your Figures

If you want to save your images as a local individual file on your computer, there are two easy ways to do that.

The first method uses `ggsave` to save the most recent ggplot figure you generated.

```{r, eval=FALSE}
ggplot(msleep2, aes(x = brainwt_log, y = sleep_rem)) + geom_point() +
  geom_smooth(method = "lm")
ggsave("plot.png", width = 5, height = 5)
```

This function will save wherever your directory is currently. Check with `getwd()` and change with `setwd(folder name)`. You can also provide a precise file path in the new file name.

```{r, eval=FALSE}
ggsave("~/Downloads/plot.png", width = 5, height = 5)
```

Here is an alternative method for saving your figures:

```{r, eval=FALSE, warning=FALSE}
pdf("plot.pdf") # creates the file
# png() also works if you want a different file format
ggplot(msleep2, aes(x = brainwt_log, y = sleep_rem)) + geom_point() +
  geom_smooth(method = "lm")
dev.off() # finishes editing the file
```

Any changes to the figure that are contained between the initial creation of the figure (i.e. the `pdf` command) and the `dev.off` command will be included in the final saved image. However, the figure is being printed directly to the file it is writing and won't appear elsewhere.

